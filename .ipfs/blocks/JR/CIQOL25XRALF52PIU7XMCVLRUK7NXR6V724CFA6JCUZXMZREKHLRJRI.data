pe=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return\'The value "\'+t+\'" is invalid for option "\'+e+\'"\'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(s(t,"type"));else{var u=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a=\'The "\'.concat(e,\'" \').concat(u," ").concat(n," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],212:[function(e,t,r){(function(r){(function(){"use strict";var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=c;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(c,i);for(var o=n(s.prototype),a=0;a<o.length;a++){var u=o[a];c.prototype[u]||(c.prototype[u]=s.prototype[u])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":214,"./_stream_writable":216,_process:152,inherits:142}],213:[function(e,t,r){"use strict";t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":215,inherits:142}],214:[function(e,t,r){(function(r,n){(function(){"use strict";var i;t.exports=x,x.ReadableState=R;e("events").EventEmitter;var s=function(e,t){return e.listeners(t).length},o=e("./internal/streams/stream"),a=e("buffer").Buffer,u=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,l=e("util");c=l&&l.debuglog?l.debuglog("stream"):function(){};var f,d,h,p=e("./internal/streams/buffer_list"),g=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,b=e("../errors").codes,y=b.ERR_INVALID_ARG_TYPE,v=b.ERR_STREAM_PUSH_AFTER_EOF,w=b.ERR_METHOD_NOT_IMPLEMENTED,_=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(x,o);var E=g.errorOrDestroy,S=["error","close","destroy","pause","resume"];function R(t,r,n){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof n&&(n=r instanceof i),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=e("string_decoder/").StringDecoder),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function x(t){if(i=i||e("./_stream_duplex"),!(this instanceof x))return new x(t);var r=this instanceof i;this._readableState=new R(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function M(e,t,r,n,i){c("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,I(e)))}(e,o);else if(i||(s=function(e,t){var r;n=t,a.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new y("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),s)E(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n)o.endEmitted?E(e,new _):k(e,o,t,!0);else if(o.ended)E(e,new v);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?k(e,o,t,!1):A(e,o)):k(e,o,t,!1)}else n||(o.reading=!1,A(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function k(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&O(e)),A(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=g.destroy,x.prototype._undestroy=g.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),M(this,e,t,!1,r)},x.prototype.unshift=function(e){return M(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(t){f||(f=e("string_decoder/").StringDecoder);var r=new f(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var j=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(I,e))}function I(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function A(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(c("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function T(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){c("readable nexttick read 0"),e.read(0)}function N(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function $(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(F,t,e))}function F(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}x.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?$(this):O(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&$(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&$(this)),null!==n&&this.emit("data",n),n},x.prototype._read=function(e){E(this,new w("_read()"))},x.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,c("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?u:m;function a(t,r){c("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",g),e.removeListener("drain",l),e.removeListener("error",h),e.removeListener("unpipe",a),n.removeListener("end",u),n.removeListener("end",m),n.removeListener("data",d),f=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}i.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,D(e))}}(n);e.on("drain",l);var f=!1;function d(t){c("ondata");var r=e.write(t);c("dest.write",r),!1===r&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!f&&(c("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function h(t){c("onerror",t),m(),e.removeListener("error",h),0===s(e,"error")&&E(e,t)}function p(){e.removeListener("finish",g),m()}function g(){c("onfinish"),e.removeListener("close",p),m()}function m(){c("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",h),e.once("close",p),e.once("finish",g),e.emit("pipe",n),i.flowing||(c("pipe resume"),n.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},x.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?O(this):i.reading||r.nextTick(L,this))),n},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(T,this),n},x.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(T,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(N,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=B,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(t,r){return void 0===h&&(h=e("./internal/streams/from")),h(x,t,r)})}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":211,"./_stream_duplex":212,"./internal/streams/async_iterator":217,"./internal/streams/buffer_list":218,"./internal/streams/destroy":219,"./internal/streams/from":221,"./internal/streams/state":223,"./internal/streams/stream":224,_process:152,buffer:132,events:138,inherits:142,"string_decoder/":225,util:131}],215:[function(e,t,r){"use strict";t.exports=l;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new i("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},{"../errors":211,"./_stream_duplex":212,inherits:142}],216:[function(e,t,r){(function(r,n){(function(){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var s;t.exports=x,x.WritableState=R;var o={deprecate:e("util-deprecate")},a=e("./internal/streams/stream"),u=e("buffer").Buffer,c=(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,f=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,p=h.ERR_INVALID_ARG_TYPE,g=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,b=h.ERR_STREAM_CANNOT_PIPE,y=h.ERR_STREAM_DESTROYED,v=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,_=h.ERR_UNKNOWN_ENCODING,E=f.errorOrDestroy;function S(){}function R(t,n,o){s=s||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=n instanceof s),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if("function"!=typeof s)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(I,e,t),e._writableState.errorEmitted=!0,E(e,i)):(s(i),e._writableState.errorEmitted=!0,E(e,i),I(e,t))}(e,n,i,t,s);else{var o=C(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||j(e,n),i?r.nextTick(k,e,n,o,s):k(e,n,o,s)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function x(t){var r=this instanceof(s=s||e("./_stream_duplex"));if(!r&&!l.call(x,this))return new x(t);this._writableState=new R(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),a.call(this)}function M(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function k(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),I(e,t)}function j(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,s=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,u=!0;r;)s[a]=r,r.isBuf||(u=!1),r=r.next,a+=1;s.allBuffers=u,M(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,l=r.encoding,f=r.callback;if(M(e,t,!1,t.objectMode?1:c.length,c,l,f),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var n=C(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(x,a),R.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(R.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===x&&(e&&e._writableState instanceof R)}})):l=function(e){return e instanceof this},x.prototype.pipe=function(){E(this,new b)},x.prototype.write=function(e,t,n){var i,s=this._writableState,o=!1,a=!s.objectMode&&(i=e,u.isBuffer(i)||i instanceof c);return a&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=S),s.ending?function(e,t){var n=new w;E(e,n),r.nextTick(t,n)}(this,n):(a||function(e,t,n,i){var s;return null===n?s=new v:"string"==typeof n||t.objectMode||(s=new p("chunk",["string","Buffer"],n)),!s||(E(e,s),r.nextTick(i,s),!1)}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else M(e,t,!1,a,n,i,s);return c}(this,s,a,e,t,n)),o},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||j(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,r){r(new g("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,I(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=f.destroy,x.prototype._undestroy=f.undestroy,x.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":211,"./_stream_duplex":212,"./internal/streams/destroy":219,"./internal/streams/state":223,"./internal/streams/stream":224,_process:152,buffer:132,inherits:142,"util-deprecate":228}],217:[function(e,t,r){(function(r){(function(){"use strict";var n;function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function h(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[d].read();null!==r&&(e[l]=null,e[o]=null,e[a]=null,t(h(r,!1)))}}function g(e){r.nextTick(p,e)}var m=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(h(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[u]?n(e[u]):t(h(void 0,!0))}))}));var n,i=this[l];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[c]?r(h(void 0,!0)):t[f](r,n)}),n)}}(i,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(h(s,!1));n=new Promise(this[f])}return this[l]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){e?r(e):t(h(void 0,!0))}))}))})),n),m);t.exports=function(e){var t,r=Object.create(b,(i(t={},d,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var n=r[d].read();n?(r[l]=null,r[o]=null,r[a]=null,e(h(n,!1))):(r[o]=e,r[a]=t)},writable:!0}),t));return r[l]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[l]=null,r[o]=null,r[a]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[l]=null,r[o]=null,r[a]=null,n(h(void 0,!0))),r[c]=!0})),e.on("readable",g.bind(null,r)),r}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":220,_process:152}],218:[function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=e("buffer").Buffer,c=e("util").inspect,l=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,n;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return u.alloc(0);for(var t,r,n,i=u.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,r=i,n=o,u.prototype.copy.call(t,r,n),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0==(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=u.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},{buffer:132,util:131}],219:[function(e,t,r){(function(e){(function(){"use strict";function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return a||u?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(n,o):(o._writableState.errorEmitted=!0,e.nextTick(r,o,t)):e.nextTick(r,o,t):s?(e.nextTick(n,o),s(t)):e.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:152}],220:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){a=!1,c=!0,o||s.call(t)},f=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,f=!0,a||s.call(t)},h=function(e){s.call(t,e)},p=function(){var e;return o&&!f?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},g=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",p),t.req?g():t.on("request",g)),t.on("end",d),t.on("finish",l),!1!==r.error&&t.on("error",h),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",d),t.removeListener("error",h),t.removeListener("close",p)}}},{"../../../errors":211}],221:[function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],222:[function(e,t,r){"use strict";var n;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function u(e){e()}function c(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var l,f=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(r);if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new s("streams");var d=r.map((function(t,i){var s=i<r.length-1;return function(t,r,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),void 0===n&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var u=!1;return function(e){if(!a&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}(t,s,i>0,(function(e){l||(l=e),e&&d.forEach(u),s||(d.forEach(u),f(l))}))}));return r.reduce(c)}},{"../../../errors":211,"./end-of-stream":220}],223:[function(e,t,r){"use strict";var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},{"../../../errors":211}],224:[function(e,t,r){arguments[4][47][0].apply(r,arguments)},{dup:47,events:138}],225:[function(e,t,r){arguments[4][162][0].apply(r,arguments)},{dup:162,"safe-buffer":164}],226:[function(e,t,r){!function(e,n){"object"==typeof r&&void 0!==t?n(r):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Superstruct={})}(this,(function(e){"use strict";class t extends TypeError{constructor(e,t){let r;const{message:n,explanation:i,...s}=e,{path:o}=e,a=0===o.length?n:`At path: ${o.join(".")} -- ${n}`;super(i??a),null!=i&&(this.cause=a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...t()])}}function r(e){return"object"==typeof e&&null!=e}function n(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function i(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function s(e,t,r,n){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:s,branch:o}=t,{type:a}=r,{refinement:u,message:c=`Expected a value of type \\`${a}\\`${u?` with refinement \\`${u}\\``:""}, but received: \\`${i(n)}\\``}=e;return{value:n,type:a,refinement:u,key:s[s.length-1],path:s,branch:o,...e,message:c}}function*o(e,t,n,i){var o;r(o=e)&&"function"==typeof o[Symbol.iterator]||(e=[e]);for(const r of e){const e=s(r,t,n,i);e&&(yield e)}}function*a(e,t,n={}){const{path:i=[],branch:s=[e],coerce:o=!1,mask:u=!1}=n,c={path:i,branch:s};if(o&&(e=t.coercer(e,c),u&&"type"!==t.type&&r(t.schema)&&r(e)&&!Array.isArray(e)))for(const r in e)void 0===t.schema[r]&&delete e[r];let l="valid";for(const r of t.validator(e,c))r.explanation=n.message,l="not_valid",yield[r,void 0];for(let[f,d,h]of t.entries(e,c)){const t=a(d,h,{path:void 0===f?i:[...i,f],branch:void 0===f?s:[...s,d],coerce:o,mask:u,message:n.message});for(const n of t)n[0]?(l=null!=n[0].refinement?"not_refined":"not_valid",yield[n[0],void 0]):o&&(d=n[1],void 0===f?e=d:e instanceof Map?e.set(f,d):e instanceof Set?e.add(d):r(e)&&(void 0!==d||f in e)&&(e[f]=d))}if("not_valid"!==l)for(const r of t.refiner(e,c))r.explanation=n.message,l="not_refined",yield[r,void 0];"valid"===l&&(yield[void 0,e])}class u{constructor(e){const{type:t,schema:r,validator:n,refiner:i,coercer:s=(e=>e),entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=s,this.validator=n?(e,t)=>o(n(e,t),t,this,e):()=>[],this.refiner=i?(e,t)=>o(i(e,t),t,this,e):()=>[]}assert(e,t){return c(e,this,t)}create(e,t){return l(e,this,t)}is(e){return d(e,this)}mask(e,t){return f(e,this,t)}validate(e,t={}){return h(e,this,t)}}function c(e,t,r){const n=h(e,t,{message:r});if(n[0])throw n[0]}function l(e,t,r){const n=h(e,t,{coerce:!0,message:r});if(n[0])throw n[0];return n[1]}function f(e,t,r){const n=h(e,t,{coerce:!0,mask:!0,message:r});if(n[0])throw n[0];return n[1]}function d(e,t){return!h(e,t)[0]}function h(e,r,n={}){const i=a(e,r,n),s=function(e){const{done:t,value:r}=e.next();return t?void 0:r}(i);if(s[0]){return[new t(s[0],(function*(){for(const e of i)e[0]&&(yield e[0])})),void 0]}return[void 0,s[1]]}function p(e,t){return new u({type:e,schema:null,validator:t})}function g(){return p("never",(()=>!1))}function m(e){const t=e?Object.keys(e):[],n=g();return new u({type:"object",schema:e||null,*entries(i){if(e&&r(i)){const r=new Set(Object.keys(i));for(const n of t)r.delete(n),yield[n,i[n],e[n]];for(const e of r)yield[e,i[e],n]}},validator:e=>r(e)||`Expected an object, but received: ${i(e)}`,coercer:e=>r(e)?{...e}:e})}function b(e){return new u({...e,validator:(t,r)=>void 0===t||e.validator(t,r),refiner:(t,r)=>void 0===t||e.refiner(t,r)})}function y(){return p("string",(e=>"string"==typeof e||`Expected a string, but received: ${i(e)}`))}function v(e){const t=Object.keys(e);return new u({type:"type",schema:e,*entries(n){if(r(n))for(const r of t)yield[r,n[r],e[r]]},validator:e=>r(e)||`Expected an object, but received: ${i(e)}`,coercer:e=>r(e)?{...e}:e})}function w(){return p("unknown",(()=>!0))}function _(e,t,r){return new u({...e,coercer:(n,i)=>d(n,t)?e.coercer(r(n,i),i):e.coercer(n,i)})}function E(e){return e instanceof Map||e instanceof Set?e.size:e.length}function S(e,t,r){return new u({...e,*refiner(n,i){yield*e.refiner(n,i);const s=o(r(n,i),i,e,n);for(const e of s)yield{...e,refinement:t}}})}e.Struct=u,e.StructError=t,e.any=function(){return p("any",(()=>!0))},e.array=function(e){return new u({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[r,n]of t.entries())yield[r,n,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${i(e)}`})},e.assert=c,e.assign=function(...e){const t="type"===e[0].type,r=e.map((e=>e.schema)),n=Object.assign({},...r);return t?v(n):m(n)},e.bigint=function(){return p("bigint",(e=>"bigint"==typeof e))},e.boolean=function(){return p("boolean",(e=>"boolean"==typeof e))},e.coerce=_,e.create=l,e.date=function(){return p("date",(e=>e instanceof Date&&!isNaN(e.getTime())||`Expected a valid \\`Date\\` object, but received: ${i(e)}`))},e.defaulted=function(e,t,r={}){return _(e,w(),(e=>{const i="function"==typeof t?t():t;if(void 0===e)return i;if(!r.strict&&n(e)&&n(i)){const t={...e};let r=!1;for(const e in i)void 0===t[e]&&(t[e]=i[e],r=!0);if(r)return t}return e}))},e.define=p,e.deprecated=function(e,t){return new u({...e,refiner:(t,r)=>void 0===t||e.refiner(t,r),validator:(r,n)=>void 0===r||(t(r,n),e.validator(r,n))})},e.dynamic=function(e){return new u({type:"dynamic",schema:null,*entries(t,r){const n=e(t,r);yield*n.entries(t,r)},validator:(t,r)=>e(t,r).validator(t,r),coercer:(t,r)=>e(t,r).coercer(t,r),refiner:(t,r)=>e(t,r).refiner(t,r)})},e.empty=function(e){return S(e,"empty",(t=>{const r=E(t);return 0===r||`Expected an empty ${e.type} but received one with a size of \\`${r}\\``}))},e.enums=function(e){const t={},r=e.map((e=>i(e))).join();for(const r of e)t[r]=r;return new u({type:"enums",schema:t,validator:t=>e.includes(t)||`Expected one of \\`${r}\\`, but received: ${i(t)}`})},e.func=function(){return p("func",(e=>"function"==typeof e||`Expected a function, but received: ${i(e)}`))},e.instance=function(e){return p("instance",(t=>t instanceof e||`Expected a \\`${e.name}\\` instance, but received: ${i(t)}`))},e.integer=function(){return p("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${i(e)}`))},e.intersection=function(e){return new u({type:"intersection",schema:null,*entries(t,r){for(const n of e)yield*n.entries(t,r)},*validator(t,r){for(const n of e)yield*n.validator(t,r)},*refiner(t,r){for(const n of e)yield*n.refiner(t,r)}})},e.is=d,e.lazy=function(e){let t;return new u({type:"lazy",schema:null,*entries(r,n){t??(t=e()),yield*t.entries(r,n)},validator:(r,n)=>(t??(t=e()),t.validator(r,n)),coercer:(r,n)=>(t??(t=e()),t.coercer(r,n)),refiner:(r,n)=>(t??(t=e()),t.refiner(r,n))})},e.literal=function(e){const t=i(e),r=typeof e;return new u({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:r=>r===e||`Expected the literal \\`${t}\\`, but received: ${i(r)}`})},e.map=function(e,t){return new u({type:"map",schema:null,*entries(r){if(e&&t&&r instanceof Map)for(const[n,i]of r.entries())yield[n,n,e],yield[n,i,t]},coercer:e=>e instanceof Map?new Map(e):e,validator:e=>e instanceof Map||`Expected a \\`Map\\` object, but received: ${i(e)}`})},e.mask=f,e.max=function(e,t,r={}){const{exclusive:n}=r;return S(e,"max",(r=>n?r<t:r<=t||`Expected a ${e.type} less than ${n?"":"or equal to "}${t} but received \\`${r}\\``))},e.min=function(e,t,r={}){const{exclusive:n}=r;return S(e,"min",(r=>n?r>t:r>=t||`Expected a ${e.type} greater than ${n?"":"or equal to "}${t} but received \\`${r}\\``))},e.never=g,e.nonempty=function(e){return S(e,"nonempty",(t=>E(t)>0||`Expected a nonempty ${e.type} but received an empty one`))},e.nullable=function(e){return new u({...e,validator:(t,r)=>null===t||e.validator(t,r),refiner:(t,r)=>null===t||e.refiner(t,r)})},e.number=function(){return p("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${i(e)}`))},e.object=m,e.omit=function(e,t){const{schema:r}=e,n={...r};for(const e of t)delete n[e];return"type"===e.type?v(n):m(n)},e.optional=b,e.partial=function(e){const t=e instanceof u?{...e.schema}:{...e};for(const e in t)t[e]=b(t[e]);return m(t)},e.pattern=function(e,t){return S(e,"pattern",(r=>t.test(r)||`Expected a ${e.type} matching \\`/${t.source}/\\` but received "${r}"`))},e.pick=function(e,t){const{schema:r}=e,n={};for(const e of t)n[e]=r[e];return m(n)},e.record=function(e,t){return new u({type:"record",schema:null,*entries(n){if(r(n))for(const r in n){const i=n[r];yield[r,r,e],yield[r,i,t]}},validator:e=>r(e)||`Expected an object, but received: ${i(e)}`})},e.refine=S,e.regexp=function(){return p("regexp",(e=>e instanceof RegExp))},e.set=function(e){return new u({type:"set",schema:null,*entries(t){if(e&&t instanceof Set)for(const r of t)yield[r,r,e]},coercer:e=>e instanceof Set?new Set(e):e,validator:e=>e instanceof Set||`Expected a \\`Set\\` object, but received: ${i(e)}`})},e.size=function(e,t,r=t){const n=`Expected a ${e.type}`,i=t===r?`of \\`${t}\\``:`between \\`${t}\\` and \\`${r}\\``;return S(e,"size",(e=>{if("number"==typeof e||e instanceof Date)return t<=e&&e<=r||`${n} ${i} but received \\`${e}\\``;if(e instanceof Map||e instanceof Set){const{size:s}=e;return t<=s&&s<=r||`${n} with a size ${i} but received one with a size of \\`${s}\\``}{const{length:s}=e;return t<=s&&s<=r||`${n} with a length ${i} but received one with a length of \\`${s}\\``}}))},e.string=y,e.struct=function(e,t){return console.warn("superstruct@0.11 - The `struct` helper has been renamed to `define`."),p(e,t)},e.trimmed=function(e){return _(e,y(),(e=>e.trim()))},e.tuple=function(e){const t=g();return new u({type:"tuple",schema:null,*entries(r){if(Array.isArray(r)){const n=Math.max(e.length,r.length);for(let i=0;i<n;i++)yield[i,r[i],e[i]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${i(e)}`})},e.type=v,e.union=function(e){const t=e.map((e=>e.type)).join(" | ");return new u({type:"union",schema:null,coercer(t){for(const r of e){const[e,n]=r.validate(t,{coerce:!0});if(!e)return n}return t},validator(r,n){const s=[];for(const t of e){const[...e]=a(r,t,n),[i]=e;if(!i[0])return[];for(const[t]of e)t&&s.push(t)}return[`Expected the value to satisfy a union of \\`${t}\\`, but received: ${i(r)}`,...s]}})},e.unknown=w,e.validate=h}))},{}],227:[function(e,t,r){(function(t,n){(function(){var i=e("process/browser.js").nextTick,s=Function.prototype.apply,o=Array.prototype.slice,a={},u=0;function c(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new c(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new c(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=u++,n=!(arguments.length<2)&&o.call(arguments,1);return a[t]=!0,i((function(){a[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof n?n:function(e){delete a[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":152,timers:227}],228:[function(e,t,r){(function(e){(function(){function r(t){try{if(!e.localStorage)return!1}catch(e){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],229:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return f.default}});var n=d(e("./v1.js")),i=d(e("./v3.js")),s=d(e("./v4.js")),o=d(e("./v5.js")),a=d(e("./nil.js")),u=d(e("./version.js")),c=d(e("./validate.js")),l=d(e("./stringify.js")),f=d(e("./parse.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./nil.js":231,"./parse.js":232,"./stringify.js":236,"./v1.js":237,"./v3.js":238,"./v4.js":240,"./v5.js":241,"./validate.js":242,"./version.js":243}],230:[function(e,t,r){"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function i(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e,t,r,n,s,o){return i((a=i(i(t,e),i(n,o)))<<(u=s)|a>>>32-u,r);var a,u}function o(e,t,r,n,i,o,a){return s(t&r|~t&n,e,t,i,o,a)}function a(e,t,r,n,i,o,a){return s(t&n|r&~n,e,t,i,o,a)}function u(e,t,r,n,i,o,a){return s(t^r^n,e,t,i,o,a)}function c(e,t,r,n,i,o,a){return s(r^(t|~n),e,t,i,o,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let i=0;i<r;i+=8){const r=e[i>>5]>>>i%32&255,s=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,s=-271733879,l=-1732584194,f=271733878;for(let t=0;t<e.length;t+=16){const n=r,d=s,h=l,p=f;r=o(r,s,l,f,e[t],7,-680876936),f=o(f,r,s,l,e[t+1],12,-389564586),l=o(l,f,r,s,e[t+2],17,606105819),s=o(s,l,f,r,e[t+3],22,-1044525330),r=o(r,s,l,f,e[t+4],7,-176418897),f=o(f,r,s,l,e[t+5],12,1200080426),l=o(l,f,r,s,e[t+6],17,-1473231341),s=o(s,l,f,r,e[t+7],22,-45705983),r=o(r,s,l,f,e[t+8],7,1770035416),f=o(f,r,s,l,e[t+9],12,-1958414417),l=o(l,f,r,s,e[t+10],17,-42063),s=o(s,l,f,r,e[t+11],22,-1990404162),r=o(r,s,l,f,e[t+12],7,1804603682),f=o(f,r,s,l,e[t+13],12,-40341101),l=o(l,f,r,s,e[t+14],17,-1502002290),s=o(s,l,f,r,e[t+15],22,1236535329),r=a(r,s,l,f,e[t+1],5,-165796510),f=a(f,r,s,l,e[t+6],9,-1069501632),l=a(l,f,r,s,e[t+11],14,643717713),s=a(s,l,f,r,e[t],20,-373897302),r=a(r,s,l,f,e[t+5],5,-701558691),f=a(f,r,s,l,e[t+10],9,38016083),l=a(l,f,r,s,e[t+15],14,-660478335),s=a(s,l,f,r,e[t+4],20,-405537848),r=a(r,s,l,f,e[t+9],5,568446438),f=a(f,r,s,l,e[t+14],9,-1019803690),l=a(l,f,r,s,e[t+3],14,-187363961),s=a(s,l,f,r,e[t+8],20,1163531501),r=a(r,s,l,f,e[t+13],5,-1444681467),f=a(f,r,s,l,e[t+2],9,-51403784),l=a(l,f,r,s,e[t+7],14,1735328473),s=a(s,l,f,r,e[t+12],20,-1926607734),r=u(r,s,l,f,e[t+5],4,-378558),f=u(f,r,s,l,e[t+8],11,-2022574463),l=u(l,f,r,s,e[t+11],16,1839030562),s=u(s,l,f,r,e[t+14],23,-35309556),r=u(r,s,l,f,e[t+1],4,-1530992060),f=u(f,r,s,l,e[t+4],11,1272893353),l=u(l,f,r,s,e[t+7],16,-155497632),s=u(s,l,f,r,e[t+10],23,-1094730640),r=u(r,s,l,f,e[t+13],4,681279174),f=u(f,r,s,l,e[t],11,-358537222),l=u(l,f,r,s,e[t+3],16,-722521979),s=u(s,l,f,r,e[t+6],23,76029189),r=u(r,s,l,f,e[t+9],4,-640364487),f=u(f,r,s,l,e[t+12],11,-421815835),l=u(l,f,r,s,e[t+15],16,530742520),s=u(s,l,f,r,e[t+2],23,-995338651),r=c(r,s,l,f,e[t],6,-198630844),f=c(f,r,s,l,e[t+7],10,1126891415),l=c(l,f,r,s,e[t+14],15,-1416354905),s=c(s,l,f,r,e[t+5],21,-57434055),r=c(r,s,l,f,e[t+12],6,1700485571),f=c(f,r,s,l,e[t+3],10,-1894986606),l=c(l,f,r,s,e[t+10],15,-1051523),s=c(s,l,f,r,e[t+1],21,-2054922799),r=c(r,s,l,f,e[t+8],6,1873313359),f=c(f,r,s,l,e[t+15],10,-30611744),l=c(l,f,r,s,e[t+6],15,-1560198380),s=c(s,l,f,r,e[t+13],21,1309151649),r=c(r,s,l,f,e[t+4],6,-145523070),f=c(f,r,s,l,e[t+11],10,-1120210379),l=c(l,f,r,s,e[t+2],15,718787259),s=c(s,l,f,r,e[t+9],21,-343485551),r=i(r,n),s=i(s,d),l=i(l,h),f=i(f,p)}return[r,s,l,f]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};r.default=l},{}],231:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="00000000-0000-0000-0000-000000000000"},{}],232:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var s=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=s},{"./validate.js":242}],233:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],234:[function(e,t,r){"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)};const i=new Uint8Array(16)},{}],235:[function(e,t,r){"use strict";function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function i(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const s=e.length/4+2,o=Math.ceil(s/16),a=new Array(o);for(let t=0;t<o;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];a[t]=r}a[o-1][14]=8*(e.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<o;++e){const s=new Uint32Array(80);for(let t=0;t<16;++t)s[t]=a[e][t];for(let e=16;e<80;++e)s[e]=i(s[e-3]^s[e-8]^s[e-14]^s[e-16],1);let o=r[0],u=r[1],c=r[2],l=r[3],f=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),a=i(o,5)+n(r,u,c,l)+f+t[r]+s[e]>>>0;f=l,l=c,c=i(u,30)>>>0,u=o,o=a}r[0]=r[0]+o>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+l>>>0,r[4]=r[4]+f>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=s},{}],236:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).substr(1));var o=function(e,t=0){const r=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,i.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=o},{"./validate.js":242}],237:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./rng.js")),i=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}let o,a,u=0,c=0;var l=function(e,t,r){let s=t&&r||0;const l=t||new Array(16);let f=(e=e||{}).node||o,d=void 0!==e.clockseq?e.clockseq:a;if(null==f||null==d){const t=e.random||(e.rng||n.default)();null==f&&(f=o=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==d&&(d=a=16383&(t[6]<<8|t[7]))}let h=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:c+1;const g=h-u+(p-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||h>u)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can\'t create more than 10M uuids/sec");u=h,c=p,a=d,h+=122192928e5;const m=(1e4*(268435455&h)+p)%4294967296;l[s++]=m>>>24&255,l[s++]=m>>>16&255,l[s++]=m>>>8&255,l[s++]=255&m;const b=h/4294967296*1e4&268435455;l[s++]=b>>>8&255,l[s++]=255&b,l[s++]=b>>>24&15|16,l[s++]=b>>>16&255,l[s++]=d>>>8|128,l[s++]=255&d;for(let e=0;e<6;++e)l[s+e]=f[e];return t||(0,i.default)(l)};r.default=l},{"./rng.js":234,"./stringify.js":236}],238:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./v35.js")),i=s(e("./md5.js"));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,n.default)("v3",48,i.default);r.default=o},{"./md5.js":230,"./v35.js":239}],239:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){function s(e,s,o,a){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof s&&(s=(0,i.default)(s)),16!==s.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+e.length);if(u.set(s),u.set(e,s.length),u=r(u),u[6]=15&u[6]|t,u[8]=63&u[8]|128,o){a=a||0;for(let e=0;e<16;++e)o[a+e]=u[e];return o}return(0,n.default)(u)}try{s.name=e}catch(e){}return s.DNS=o,s.URL=a,s},r.URL=r.DNS=void 0;var n=s(e("./stringify.js")),i=s(e("./parse.js"));function s(e){return e&&e.__esModule?e:{default:e}}const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=o;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=a},{"./parse.js":232,"./stringify.js":236}],240:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./rng.js")),i=s(e("./stringify.js"));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(e,t,r){const s=(e=e||{}).random||(e.rng||n.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return(0,i.default)(s)};r.default=o},{"./rng.js":234,"./stringify.js":236}],241:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("./v35.js")),i=s(e("./sha1.js"));function s(e){return e&&e.__esModule?e:{default:e}}var o=(0,n.default)("v5",80,i.default);r.default=o},{"./sha1.js":235,"./v35.js":239}],242:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var s=function(e){return"string"==typeof e&&i.default.test(e)};r.default=s},{"./regex.js":233}],243:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var s=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};r.default=s},{"./validate.js":242}],244:[function(e,t,r){t.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}}},{}],245:[function(e,t,r){"use strict";t.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},{}],246:[function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function s(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}t.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,s=this.head;null!==s&&i<e;i++)s=s.next;for(;null!==s&&i<t;i++,s=s.next)r.push(s.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,s=this.tail;null!==s&&i>t;i--)s=s.prev;for(;null!==s&&i>e;i--,s=s.prev)r.push(s.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;var o=[];for(n=0;s&&n<t;n++)o.push(s.value),s=this.removeNode(s);null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(n=0;n<r.length;n++)s=i(this,s,r[n]);return o},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{e("./iterator.js")(n)}catch(e){}},{"./iterator.js":245}],247:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){return function(){const{doctype:e}=window.document;if(e)return"html"===e.name;return!0}()&&function(){const e=[/\\.xml$/u,/\\.pdf$/u],t=window.location.pathname;for(let r=0;r<e.length;r++)if(e[r].test(t))return!1;return!0}()&&function(){const e=document.documentElement.nodeName;if(e)return"html"===e.toLowerCase();return!0}()&&!function(){const e=["execution.consensys.io","execution.metamask.io","uscourts.gov","dropbox.com","webbyawards.com","cdn.shopify.com/s/javascripts/tricorder/xtld-read-only-frame.html","adyen.com","gravityforms.com","harbourair.com","ani.gamer.com.tw","blueskybooking.com","sharefile.com"],t=window.location.href;let r;for(let n=0;n<e.length;n++){const i=e[n].replaceAll(".","\\\\.");if(r=new RegExp(`(?:https?:\\\\/\\\\/)(?:(?!${i}).)*$`,"u"),!r.test(t))return!0}return!1}()}},{}]},{},[1]);'+`//# sourceURL=${u.default.runtime.getURL("inpage.js")}\n`,m="metamask-contentscript",g="metamask-inpage",b="metamask-phishing-warning-page",y="metamask-phishing-safelist",v="metamask-provider",w="provider",_="publicConfig";let S,E,x,A,k,M,T;const O=new URL("https://metamask.github.io/phishing-warning/v2.1.0/");let R,P,C,I,j,N,B,L,U,D,$,F,H;const z=()=>{C=u.default.runtime.connect({name:m}),I=new i.default(C),P=new s.default,P.setMaxListeners(25),(0,o.default)(P,I,P,(e=>{Q("MetaMask Background Multiplex",e),window.postMessage({target:b,data:{name:y,data:{jsonrpc:"2.0",method:"METAMASK_STREAM_FAILURE"}}},window.location.origin)})),R=P.createStream(y),(0,o.default)(j,R,j,(e=>console.debug(`MetaMask: Muxed traffic for channel "${y}" failed.`,e))),C.onDisconnect.addListener(V)},V=()=>{const e=(0,l.checkForLastError)();C.onDisconnect.removeListener(V),j.removeAllListeners(),P.removeAllListeners(),P.destroy(),R.removeAllListeners(),R.destroy(),I=null,e&&(console.warn(`${e} Resetting the phishing streams.`),setTimeout(z,1e3))},q=e=>{if(e.name===c.EXTENSION_MESSAGES.READY)return I||z(),Promise.resolve(`MetaMask: handled "${c.EXTENSION_MESSAGES.READY}" for phishing streams`)},W=()=>{!function(){const e=new n.WindowPostMessageStream({name:m,target:b});N=new s.default,N.setMaxListeners(25),(0,o.default)(N,e,N,(e=>Q("MetaMask Inpage Multiplex",e))),j=N.createStream(y)}(),z(),u.default.runtime.onMessage.addListener(q)};let J=!1;const K=()=>{J=!0,U=u.default.runtime.connect({name:m}),$=new i.default(U),$.on("data",ee),B=new s.default,B.setMaxListeners(25),B.ignoreStream(_),(0,o.default)(B,$,B,(e=>{Q("MetaMask Background Multiplex",e),te()})),L=B.createStream(v),(0,o.default)(H,L,H,(e=>console.debug(`MetaMask: Muxed traffic for channel "${v}" failed.`,e))),D=B.createStream("phishing"),D.once("data",re),U.onDisconnect.addListener(X)},G=()=>{S=new s.default,S.setMaxListeners(25),T=(0,a.obj)(((e,t,r)=>{var n;(null==e?void 0:e.name)===v&&"metamask_accountsChanged"===(null===(n=e.data)||void 0===n?void 0:n.method)&&(e.data.method="wallet_accountsChanged",e.data.result=e.data.params,delete e.data.params),r(null,e)})),(0,o.default)(S,$,T,S,(e=>{Q("MetaMask Background Legacy Multiplex",e),te()})),E=S.createStream(v),(0,o.default)(k,E,k,(e=>console.debug(`MetaMask: Muxed traffic between channels "${w}" and "${v}" failed.`,e))),x=S.createStream(_),(0,o.default)(M,x,M,(e=>console.debug(`MetaMask: Muxed traffic for channel "${_}" failed.`,e)))},Y=e=>{if(e.name===c.EXTENSION_MESSAGES.READY)return $||(K(),G()),Promise.resolve(`MetaMask: handled ${c.EXTENSION_MESSAGES.READY}`)},X=e=>{const t=e||(0,l.checkForLastError)();U.onDisconnect.removeListener(X),H.removeAllListeners(),B.removeAllListeners(),B.destroy(),L.removeAllListeners(),L.destroy(),$=null,k.removeAllListeners(),M.removeAllListeners(),S.removeAllListeners(),S.destroy(),E.removeAllListeners(),E.destroy(),x.removeAllListeners(),x.destroy(),t&&(console.warn(`${t} Resetting the streams.`),setTimeout(K,1e3))},Z=()=>{(()=>{const e=new n.WindowPostMessageStream({name:m,target:g});F=new s.default,F.setMaxListeners(25),(0,o.default)(F,e,F,(e=>Q("MetaMask Inpage Multiplex",e))),H=F.createStream(v)})(),(()=>{const e=new n.WindowPostMessageStream({name:"contentscript",target:"inpage"});A=new s.default,A.setMaxListeners(25),(0,o.default)(A,e,A,(e=>Q("MetaMask Legacy Inpage Multiplex",e))),k=A.createStream(w),M=A.createStream(_)})(),K(),G(),u.default.runtime.onMessage.addListener(Y)};function Q(e,t){console.debug(`MetaMask: Content script lost connection to "${e}".`,t)}function ee(e){J&&f.isManifestV3&&"metamask_chainChanged"===e.data.method&&(J=!1,window.postMessage({target:g,data:{name:v,data:{jsonrpc:"2.0",method:"METAMASK_EXTENSION_CONNECT_CAN_RETRY"}}},window.location.origin))}function te(){window.postMessage({target:g,data:{name:v,data:{jsonrpc:"2.0",method:"METAMASK_STREAM_FAILURE"}}},window.location.origin)}function re(){console.debug("MetaMask: Routing to Phishing Warning page.");const{hostname:e,href:t}=window.location,r=new URLSearchParams({hostname:e,href:t});for(window.location.href=`https://metamask.github.io/phishing-warning/v2.1.0/#${r}`;;)console.log("MetaMask: Locking js execution, redirection will complete shortly")}window.location.origin===O.origin&&window.location.pathname===O.pathname?W():(0,d.default)()&&(f.isManifestV3||function(e){try{const t=document.head||document.documentElement,r=document.createElement("script");r.setAttribute("async","false"),r.textContent=e,t.insertBefore(r,t.children[0]),t.removeChild(r)}catch(e){console.error("MetaMask: Provider injection failed.",e)}}(p),Z(),document.prerendering&&document.addEventListener("prerenderingchange",(()=>{X(new Error("Prerendered page has become active."))})))},{"../../shared/constants/app":625,"../../shared/modules/browser-runtime.utils":628,"../../shared/modules/mv3.utils":629,"../../shared/modules/provider-injection":630,"@metamask/post-message-stream":128,"extension-port-stream":422,"obj-multiplex":504,path:507,pump:510,through2:617,"webextension-polyfill":621}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseController=void 0;class n{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}r.BaseController=n,r.default=n},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getPersistentState=r.getAnonymizedState=r.BaseController=void 0;const n=e("immer");(0,n.enablePatches)();function i(e,t,r){return Object.keys(e).reduce(((n,i)=>{try{const s=t[i];if(!s)throw new Error(`No metadata found for '${i}'`);const o=s[r],a=e[i];return"function"==typeof o?n[i]=o(a):o&&(n[i]=a),n}catch(e){return setTimeout((()=>{throw e})),n}}),{})}r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:n}){this.messagingSystem=e,this.name=r,this.internalState=n,this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state))}get state(){return this.internalState}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,i]=n.produceWithPatches(this.internalState,e);return this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:i}}applyPatches(e){const t=(0,n.applyPatches)(this.internalState,e);this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},r.getPersistentState=function(e,t){return i(e,t,"persist")}},{immer:471}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ControllerMessenger=r.RestrictedControllerMessenger=void 0;class n{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:n}){this.controllerMessenger=e,this.controllerName=t,this.allowedActions=r||null,this.allowedEvents=n||null}registerActionHandler(e,t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed registering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.registerActionHandler(e,t)}unregisterActionHandler(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed unregistering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.unregisterActionHandler(e)}call(e,...t){if(null===this.allowedActions)throw new Error("No actions allowed");if(!this.allowedActions.includes(e))throw new Error(`Action missing from allow list: ${e}`);return this.controllerMessenger.call(e,...t)}publish(e,...t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed publishing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.publish(e,...t)}subscribe(e,t,r){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);return r?this.controllerMessenger.subscribe(e,t,r):this.controllerMessenger.subscribe(e,t)}unsubscribe(e,t){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);this.controllerMessenger.unsubscribe(e,t)}clearEventSubscriptions(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed clearing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.clearEventSubscriptions(e)}}r.RestrictedControllerMessenger=n;r.ControllerMessenger=class{constructor(){this.actions=new Map,this.events=new Map,this.eventPayloadCache=new Map}registerActionHandler(e,t){if(this.actions.has(e))throw new Error(`A handler for ${e} has already been registered`);this.actions.set(e,t)}unregisterActionHandler(e){this.actions.delete(e)}clearActions(){this.actions.clear()}call(e,...t){const r=this.actions.get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}publish(e,...t){const r=this.events.get(e);if(r)for(const[e,n]of r.entries())try{if(n){const r=this.eventPayloadCache.get(e),i=n(...t);i!==r&&(this.eventPayloadCache.set(e,i),e(i,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let n=this.events.get(e);n||(n=new Map,this.events.set(e,n)),n.set(t,r)}unsubscribe(e,t){const r=this.events.get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&this.eventPayloadCache.delete(t),r.delete(t)}clearEventSubscriptions(e){this.events.delete(e)}clearSubscriptions(){this.events.clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new n({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}},{}],5:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.getPersistentState=r.getAnonymizedState=r.BaseControllerV2=r.BaseController=void 0;var s=e("./BaseController");Object.defineProperty(r,"BaseController",{enumerable:!0,get:function(){return s.BaseController}});var o=e("./BaseControllerV2");Object.defineProperty(r,"BaseControllerV2",{enumerable:!0,get:function(){return o.BaseController}}),Object.defineProperty(r,"getAnonymizedState",{enumerable:!0,get:function(){return o.getAnonymizedState}}),Object.defineProperty(r,"getPersistentState",{enumerable:!0,get:function(){return o.getPersistentState}}),i(e("./ControllerMessenger"),r)},{"./BaseController":2,"./BaseControllerV2":3,"./ControllerMessenger":4}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=r.ApprovalType=r.ORIGIN_METAMASK=r.OPENSEA_TEST_API_URL=r.OPENSEA_API_URL=r.OPENSEA_PROXY_URL=r.BUILT_IN_NETWORKS=r.TESTNET_TICKER_SYMBOLS=r.ASSET_TYPES=r.GWEI=r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=r.ERC1155_METADATA_URI_INTERFACE_ID=r.ERC1155_INTERFACE_ID=r.ERC721_ENUMERABLE_INTERFACE_ID=r.ERC721_METADATA_INTERFACE_ID=r.ERC721_INTERFACE_ID=r.ERC20=r.ERC1155=r.ERC721=r.MAX_SAFE_CHAIN_ID=r.GANACHE_CHAIN_ID=r.IPFS_DEFAULT_GATEWAY_URL=r.FALL_BACK_VS_CURRENCY=r.RPC=void 0;const n=e("./types");r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH"},r.BUILT_IN_NETWORKS={[n.NetworkType.goerli]:{chainId:n.ChainId.goerli,ticker:n.NetworksTicker.goerli,rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.goerli}.etherscan.io`}},[n.NetworkType.sepolia]:{chainId:n.ChainId.sepolia,ticker:n.NetworksTicker.sepolia,rpcPrefs:{blockExplorerUrl:`https://${n.NetworkType.sepolia}.etherscan.io`}},[n.NetworkType.mainnet]:{chainId:n.ChainId.mainnet,ticker:n.NetworksTicker.mainnet,rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[n.NetworkType["linea-goerli"]]:{chainId:n.ChainId["linea-goerli"],ticker:n.NetworksTicker["linea-goerli"],rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[n.NetworkType["linea-mainnet"]]:{chainId:n.ChainId["linea-mainnet"],ticker:n.NetworksTicker["linea-mainnet"],rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[n.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,rpcPrefs:void 0}},r.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v1",r.OPENSEA_API_URL="https://api.opensea.io/api/v1",r.OPENSEA_TEST_API_URL="https://testnets-api.opensea.io/api/v1",r.ORIGIN_METAMASK="metamask",function(e){e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset"}(r.ApprovalType||(r.ApprovalType={})),r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP={[n.ChainId.goerli]:n.BuiltInNetworkName.Goerli,[n.ChainId.sepolia]:n.BuiltInNetworkName.Sepolia,[n.ChainId.mainnet]:n.BuiltInNetworkName.Mainnet,[n.ChainId["linea-goerli"]]:n.BuiltInNetworkName.LineaGoerli,[n.ChainId["linea-mainnet"]]:n.BuiltInNetworkName.LineaMainnet,[n.ChainId.aurora]:n.BuiltInNetworkName.Aurora}},{"./types":10}],7:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./constants"),r),i(e("./util"),r),i(e("./types"),r),i(e("./siwe"),r)},{"./constants":6,"./siwe":9,"./types":10,"./util":11}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=e("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("controller-utils")},{"@metamask/utils":21}],9:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.detectSIWE=r.isValidSIWEOrigin=r.parseDomainParts=void 0;const n=e("@spruceid/siwe-parser"),i=e("ethereumjs-util"),s=e("./logger"),o=(0,s.createModuleLogger)(s.projectLogger,"detect-siwe");function a(e){try{const n="string"!=typeof(r=e)?r:(0,i.isHexPrefixed)(r)?r.slice(2):r,s=t.from(n,"hex");return 32===s.length?e:s.toString("utf8")}catch(t){return o(t),e}var r}const u={"http:":"80","https:":"443"};r.parseDomainParts=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.isValidSIWEOrigin=e=>{var t;try{const{origin:n,siwe:i}=e;if(!n||!(null===(t=null==i?void 0:i.parsedMessage)||void 0===t?void 0:t.domain))return!1;const s=new URL(n),o=(0,r.parseDomainParts)(i.parsedMessage.domain,s.protocol);return 0===o.hostname.localeCompare(s.hostname,void 0,{sensitivity:"accent"})&&(""!==o.port&&o.port!==s.port?""===s.port&&o.port===u[s.protocol]:""===o.username||o.username===s.username)}catch(e){return o(e),!1}};r.detectSIWE=e=>{try{const{data:t}=e,r=a(t);return{isSIWEMessage:!0,parsedMessage:new n.ParsedMessage(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)},{"./logger":8,"@spruceid/siwe-parser":327,buffer:365,"ethereumjs-util":411}],10:[function(e,t,r){"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.NetworksTicker=r.ChainId=r.BuiltInNetworkName=r.isNetworkType=r.NetworkType=r.InfuraNetworkType=void 0,r.InfuraNetworkType={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-mainnet":"linea-mainnet"},r.NetworkType=Object.assign(Object.assign({},r.InfuraNetworkType),{rpc:"rpc"}),r.isNetworkType=function(e){return Object.values(r.NetworkType).includes(e)},function(e){e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaMainnet="linea-mainnet",e.Aurora="aurora"}(n=r.BuiltInNetworkName||(r.BuiltInNetworkName={})),r.ChainId={[n.Mainnet]:"0x1",[n.Goerli]:"0x5",[n.Sepolia]:"0xaa36a7",[n.Aurora]:"0x4e454152",[n.LineaGoerli]:"0xe704",[n.LineaMainnet]:"0xe708"},function(e){e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc=""}(r.NetworksTicker||(r.NetworksTicker={}))},{}],11:[function(e,t,r){(function(t){(function(){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isValidJson=r.isNonEmptyArray=r.isPlainObject=r.convertHexToDecimal=r.query=r.normalizeEnsName=r.timeoutFetch=r.fetchWithErrorHandling=r.handleFetch=r.successfulFetch=r.isSmartContractCode=r.isValidHexAddress=r.toChecksumHexAddress=r.safelyExecuteWithTimeout=r.safelyExecute=r.toHex=r.fromHex=r.hexToText=r.hexToBN=r.getBuyURL=r.weiHexToGweiDec=r.gweiDecToWEIBN=r.fractionBN=r.BNToHex=r.isSafeChainId=void 0;const s=e("@metamask/utils"),o=i(e("eth-ens-namehash")),a=e("ethereumjs-util"),u=e("ethjs-unit"),c=i(e("fast-deep-equal")),l=e("./constants"),f=new Error("timeout");function d(e){return e?new a.BN((0,a.stripHexPrefix)(e),16):new a.BN(0)}function h(e,t){return n(this,void 0,void 0,(function*(){const r=yield fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${e}'`);return r}))}function p(e,t){return n(this,void 0,void 0,(function*(){const r=yield h(e,t);return yield r.json()}))}r.isSafeChainId=function(e){if(!(0,a.isHexString)(e))return!1;const t=Number.parseInt(e);return Number.isSafeInteger(t)&&t>0&&t<=l.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return(0,a.addHexPrefix)(e.toString(16))},r.fractionBN=function(e,t,r){const n=new a.BN(t),i=new a.BN(r);return e.mul(n).div(i)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new a.BN(0);const t=e.toString().split("."),r=t[0]||"0";let n=t[1]||"";if(!n)return(0,u.toWei)(r,"gwei");if(n.length<=9)return(0,u.toWei)(`${r}.${n}`,"gwei");const i=n.slice(9)[0];n=n.slice(0,9);let s=(0,u.toWei)(`${r}.${n}`,"gwei");return Number(i)>=5&&(s=s.add(new a.BN(1))),s},r.weiHexToGweiDec=function(e){const t=new a.BN((0,a.stripHexPrefix)(e),16);return(0,u.fromWei)(t,"gwei").toString(10)},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=d,r.hexToText=function(e){try{const r=(0,a.stripHexPrefix)(e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return a.BN.isBN(e)?e:new a.BN(d(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&(0,s.isStrictHexString)(e)?e:`0x${a.BN.isBN(e)?e.toString(16):new a.BN(e.toString(),10).toString(16)}`},r.safelyExecute=function(e,t=!1){return n(this,void 0,void 0,(function*(){try{return yield e()}catch(e){return void(t&&console.error(e))}}))},r.safelyExecuteWithTimeout=function(e,t=!1,r=500){return n(this,void 0,void 0,(function*(){try{return yield Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(f)}),r)))])}catch(e){return void(t&&console.error(e))}}))},r.toChecksumHexAddress=function(e){const t=(0,a.addHexPrefix)(e);return(0,a.isHexString)(t)?(0,a.toChecksumAddress)(t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?(0,a.addHexPrefix)(e):e;return!!(0,a.isHexString)(r)&&(0,a.isValidAddress)(r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=h,r.handleFetch=p,r.fetchWithErrorHandling=function({url:e,options:t,timeout:r,errorCodesToCatch:i}){return n(this,void 0,void 0,(function*(){let n;try{n=r?Promise.race([yield p(e,t),new Promise(((e,t)=>setTimeout((()=>{t(f)}),r)))]):yield p(e,t)}catch(e){!function(e,t=[]){var r;if(!e)return;const n=t.some((t=>{var r;return null===(r=e.message)||void 0===r?void 0:r.includes(`Fetch failed with status '${t}'`)}));if(!(e instanceof Error&&(n||(null===(r=e.message)||void 0===r?void 0:r.includes("Failed to fetch"))||e===f)))throw e;console.error(e)}(e,i)}return n}))},r.timeoutFetch=function(e,t,r=500){return n(this,void 0,void 0,(function*(){return Promise.race([h(e,t),new Promise(((e,t)=>setTimeout((()=>{t(f)}),r)))])}))},r.normalizeEnsName=function(e){if(e&&"string"==typeof e)try{const t=o.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((n,i)=>{const s=(e,t)=>{e?i(e):n(t)};t in e&&"function"==typeof e[t]?e[t](...r,s):e.sendAsync({method:t,params:r},s)}))};r.convertHexToDecimal=(e="0x0")=>(0,a.isHexString)(e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return(0,c.default)(e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)},{"./constants":6,"@metamask/utils":21,buffer:365,"eth-ens-namehash":402,"ethereumjs-util":411,"ethjs-unit":420,"fast-deep-equal":423}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{AssertionError:function(){return s},assert:function(){return o},assertStruct:function(){return a},assertExhaustive:function(){return u}});const n=e("superstruct");function i(e,t){return r=e,Boolean("string"==typeof r?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var r}class s extends Error{constructor(e){var t,r,n;super(e.message),n="ERR_ASSERTION",(r="code")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}}function o(e,t="Assertion failed.",r=s){if(!e){if(t instanceof Error)throw t;throw i(r,t)}}function a(e,t,r="Assertion failed",o=s){try{(0,n.assert)(e,t)}catch(e){throw i(o,`${r}: ${function(e){const t=function(e){return"object"==typeof e&&null!==e&&"message"in e}(e)?e.message:String(e);return t.endsWith(".")?t.slice(0,-1):t}(e)}.`)}}function u(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}},{superstruct:601}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"base64",{enumerable:!0,get:function(){return s}});const n=e("superstruct"),i=e("./assert"),s=(e,t={})=>{const r=t.paddingRequired??!1,s=t.characterSet??"base64";let o,a;return"base64"===s?o=String.raw`[A-Za-z0-9+\/]`:((0,i.assert)("base64url"===s),o=String.raw`[-_A-Za-z0-9]`),a=r?new RegExp(`^(?:${o}{4})*(?:${o}{3}=|${o}{2}==)?$`,"u"):new RegExp(`^(?:${o}{4})*(?:${o}{2,3}|${o}{3}=|${o}{2}==)?$`,"u"),(0,n.pattern)(e,a)}},{"./assert":12,superstruct:601}],14:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{isBytes:function(){return c},assertIsBytes:function(){return l},bytesToHex:function(){return f},bytesToBigInt:function(){return d},bytesToSignedBigInt:function(){return h},bytesToNumber:function(){return p},bytesToString:function(){return m},hexToBytes:function(){return g},bigIntToBytes:function(){return b},signedBigIntToBytes:function(){return y},numberToBytes:function(){return v},stringToBytes:function(){return w},valueToBytes:function(){return _},concatBytes:function(){return S},createDataView:function(){return E}});const n=e("./assert"),i=e("./hex"),s=48,o=58,a=87;const u=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function c(e){return e instanceof Uint8Array}function l(e){(0,n.assert)(c(e),"Value must be a Uint8Array.")}function f(e){if(l(e),0===e.length)return"0x";const t=u(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,i.add0x)(r.join(""))}function d(e){l(e);const t=f(e);return BigInt(t)}function h(e){l(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)}function p(e){l(e);const t=d(e);return(0,n.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)}function m(e){return l(e),(new TextDecoder).decode(e)}function g(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,i.assertIsHexString)(e);const t=(0,i.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),i=r.charCodeAt(2*e+1),u=t-(t<o?s:a),c=i-(i<o?s:a);n[e]=16*u+c}return n}function b(e){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return g(e.toString(16))}function y(e,t){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)("number"==typeof t,"Byte length must be a number."),(0,n.assert)(t>0,"Byte length must be greater than 0."),(0,n.assert)(function(e,t){(0,n.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const i=new Uint8Array(t);for(let e=0;e<i.length;e++)i[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return i.reverse()}function v(e){(0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return g(e.toString(16))}function w(e){return(0,n.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function _(e){if("bigint"==typeof e)return b(e);if("number"==typeof e)return v(e);if("string"==typeof e)return e.startsWith("0x")?g(e):w(e);if(c(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}function S(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const i=_(e[n]);t[n]=i,r+=i.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n}function E(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)},{"./assert":12,"./hex":20,buffer:365}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{CAIP_CHAIN_ID_REGEX:function(){return i},CAIP_NAMESPACE_REGEX:function(){return s},CAIP_REFERENCE_REGEX:function(){return o},CAIP_ACCOUNT_ID_REGEX:function(){return a},CAIP_ACCOUNT_ADDRESS_REGEX:function(){return u},CaipChainIdStruct:function(){return c},CaipNamespaceStruct:function(){return l},CaipReferenceStruct:function(){return f},CaipAccountIdStruct:function(){return d},CaipAccountAddressStruct:function(){return h},isCaipChainId:function(){return p},isCaipNamespace:function(){return m},isCaipReference:function(){return g},isCaipAccountId:function(){return b},isCaipAccountAddress:function(){return y},parseCaipChainId:function(){return v},parseCaipAccountId:function(){return w}});const n=e("superstruct"),i=RegExp("^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$","u"),s=/^[-a-z0-9]{3,8}$/u,o=/^[-_a-zA-Z0-9]{1,32}$/u,a=RegExp("^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$","u"),u=/^[-.%a-zA-Z0-9]{1,128}$/u,c=(0,n.pattern)((0,n.string)(),i),l=(0,n.pattern)((0,n.string)(),s),f=(0,n.pattern)((0,n.string)(),o),d=(0,n.pattern)((0,n.string)(),a),h=(0,n.pattern)((0,n.string)(),u);function p(e){return(0,n.is)(e,c)}function m(e){return(0,n.is)(e,l)}function g(e){return(0,n.is)(e,f)}function b(e){return(0,n.is)(e,d)}function y(e){return(0,n.is)(e,h)}function v(e){const t=i.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}}function w(e){const t=a.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}}},{superstruct:601}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ChecksumStruct",{enumerable:!0,get:function(){return s}});const n=e("superstruct"),i=e("./base64"),s=(0,n.size)((0,i.base64)((0,n.string)(),{paddingRequired:!0}),44,44)},{"./base64":13,superstruct:601}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{createNumber:function(){return d},createBigInt:function(){return h},createBytes:function(){return p},createHex:function(){return m}});const n=e("superstruct"),i=e("./assert"),s=e("./bytes"),o=e("./hex"),a=(0,n.union)([(0,n.number)(),(0,n.bigint)(),(0,n.string)(),o.StrictHexStruct]),u=(0,n.coerce)((0,n.number)(),a,Number),c=(0,n.coerce)((0,n.bigint)(),a,BigInt),l=((0,n.union)([o.StrictHexStruct,(0,n.instance)(Uint8Array)]),(0,n.coerce)((0,n.instance)(Uint8Array),(0,n.union)([o.StrictHexStruct]),s.hexToBytes)),f=(0,n.coerce)(o.StrictHexStruct,(0,n.instance)(Uint8Array),s.bytesToHex);function d(e){try{const t=(0,n.create)(e,u);return(0,i.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof n.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}}function h(e){try{return(0,n.create)(e,c)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}}function p(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,n.create)(e,l)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}function m(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,n.create)(e,f)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}},{"./assert":12,"./bytes":14,"./hex":20,superstruct:601}],18:[function(e,t,r){"use strict";function n(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function i(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,n(e,t,"get"))}function s(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function o(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,n(e,t,"set"),r),r}Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{FrozenMap:function(){return c},FrozenSet:function(){return d}});var a=new WeakMap;let u=Symbol.iterator;class c{get size(){return i(this,a).size}[u](){return i(this,a)[Symbol.iterator]()}entries(){return i(this,a).entries()}forEach(e,t){return i(this,a).forEach(((r,n,i)=>e.call(t,r,n,this)))}get(e){return i(this,a).get(e)}has(e){return i(this,a).has(e)}keys(){return i(this,a).keys()}values(){return i(this,a).values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}constructor(e){s(this,a,{writable:!0,value:void 0}),o(this,a,new Map(e)),Object.freeze(this)}}var l=new WeakMap;let f=Symbol.iterator;class d{get size(){return i(this,l).size}[f](){return i(this,l)[Symbol.iterator]()}entries(){return i(this,l).entries()}forEach(e,t){return i(this,l).forEach(((r,n,i)=>e.call(t,r,n,this)))}has(e){return i(this,l).has(e)}keys(){return i(this,l).keys()}values(){return i(this,l).values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}constructor(e){s(this,l,{writable:!0,value:void 0}),o(this,l,new Set(e)),Object.freeze(this)}}Object.freeze(c),Object.freeze(c.prototype),Object.freeze(d),Object.freeze(d.prototype)},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{HexStruct:function(){return a},StrictHexStruct:function(){return u},HexAddressStruct:function(){return c},HexChecksumAddressStruct:function(){return l},isHexString:function(){return f},isStrictHexString:function(){return d},assertIsHexString:function(){return h},assertIsStrictHexString:function(){return p},isValidHexAddress:function(){return m},getChecksumAddress:function(){return g},isValidChecksumAddress:function(){return b},add0x:function(){return y},remove0x:function(){return v}});const n=e("@noble/hashes/sha3"),i=e("superstruct"),s=e("./assert"),o=e("./bytes"),a=(0,i.pattern)((0,i.string)(),/^(?:0x)?[0-9a-f]+$/iu),u=(0,i.pattern)((0,i.string)(),/^0x[0-9a-f]+$/iu),c=(0,i.pattern)((0,i.string)(),/^0x[0-9a-f]{40}$/u),l=(0,i.pattern)((0,i.string)(),/^0x[0-9a-fA-F]{40}$/u);function f(e){return(0,i.is)(e,a)}function d(e){return(0,i.is)(e,u)}function h(e){(0,s.assert)(f(e),"Value must be a hexadecimal string.")}function p(e){(0,s.assert)(d(e),'Value must be a hexadecimal string, starting with "0x".')}function m(e){return(0,i.is)(e,c)||b(e)}function g(e){(0,s.assert)((0,i.is)(e,l),"Invalid hex address.");const t=v(e.toLowerCase()),r=v((0,o.bytesToHex)((0,n.keccak_256)(t)));return`0x${t.split("").map(((e,t)=>{const n=r[t];return(0,s.assert)((0,i.is)(n,(0,i.string)()),"Hash shorter than address."),parseInt(n,16)>7?e.toUpperCase():e})).join("")}`}function b(e){return!!(0,i.is)(e,l)&&g(e)===e}function y(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`}function v(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}},{"./assert":12,"./bytes":14,"@noble/hashes/sha3":321,superstruct:601}],21:[function(e,t,r){"use strict";function n(e,t){return Object.keys(e).forEach((function(r){"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})})),e}Object.defineProperty(r,"__esModule",{value:!0}),n(e("./assert"),r),n(e("./base64"),r),n(e("./bytes"),r),n(e("./caip-types"),r),n(e("./checksum"),r),n(e("./coercers"),r),n(e("./collections"),r),n(e("./encryption-types"),r),n(e("./hex"),r),n(e("./json"),r),n(e("./keyring"),r),n(e("./logging"),r),n(e("./misc"),r),n(e("./number"),r),n(e("./opaque"),r),n(e("./time"),r),n(e("./transaction-types"),r),n(e("./versions"),r)},{"./assert":12,"./base64":13,"./bytes":14,"./caip-types":15,"./checksum":16,"./coercers":17,"./collections":18,"./encryption-types":19,"./hex":20,"./json":22,"./keyring":23,"./logging":24,"./misc":25,"./number":26,"./opaque":27,"./time":28,"./transaction-types":29,"./versions":30}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{UnsafeJsonStruct:function(){return s},JsonStruct:function(){return o},isValidJson:function(){return a},getSafeJson:function(){return u},getJsonSize:function(){return c},jsonrpc2:function(){return l},JsonRpcVersionStruct:function(){return f},JsonRpcIdStruct:function(){return d},JsonRpcErrorStruct:function(){return h},JsonRpcParamsStruct:function(){return p},JsonRpcRequestStruct:function(){return m},JsonRpcNotificationStruct:function(){return g},isJsonRpcNotification:function(){return b},assertIsJsonRpcNotification:function(){return y},isJsonRpcRequest:function(){return v},assertIsJsonRpcRequest:function(){return w},PendingJsonRpcResponseStruct:function(){return _},JsonRpcSuccessStruct:function(){return S},JsonRpcFailureStruct:function(){return E},JsonRpcResponseStruct:function(){return x},isPendingJsonRpcResponse:function(){return A},assertIsPendingJsonRpcResponse:function(){return k},isJsonRpcResponse:function(){return M},assertIsJsonRpcResponse:function(){return T},isJsonRpcSuccess:function(){return O},assertIsJsonRpcSuccess:function(){return R},isJsonRpcFailure:function(){return P},assertIsJsonRpcFailure:function(){return C},isJsonRpcError:function(){return I},assertIsJsonRpcError:function(){return j},getJsonRpcIdValidator:function(){return N}});const n=e("superstruct"),i=e("./assert"),s=(0,n.union)([(0,n.literal)(null),(0,n.boolean)(),(0,n.define)("finite number",(e=>(0,n.is)(e,(0,n.number)())&&Number.isFinite(e))),(0,n.string)(),(0,n.array)((0,n.lazy)((()=>s))),(0,n.record)((0,n.string)(),(0,n.lazy)((()=>s)))]),o=(0,n.coerce)(s,(0,n.any)(),(e=>((0,i.assertStruct)(e,s),JSON.parse(JSON.stringify(e,((e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t}))))));function a(e){try{return u(e),!0}catch{return!1}}function u(e){return(0,n.create)(e,o)}function c(e){(0,i.assertStruct)(e,o,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength}const l="2.0",f=(0,n.literal)(l),d=(0,n.nullable)((0,n.union)([(0,n.number)(),(0,n.string)()])),h=(0,n.object)({code:(0,n.integer)(),message:(0,n.string)(),data:(0,n.optional)(o),stack:(0,n.optional)((0,n.string)())}),p=(0,n.union)([(0,n.record)((0,n.string)(),o),(0,n.array)(o)]),m=(0,n.object)({id:d,jsonrpc:f,method:(0,n.string)(),params:(0,n.optional)(p)}),g=(0,n.object)({jsonrpc:f,method:(0,n.string)(),params:(0,n.optional)(p)});function b(e){return(0,n.is)(e,g)}function y(e,t){(0,i.assertStruct)(e,g,"Invalid JSON-RPC notification",t)}function v(e){return(0,n.is)(e,m)}function w(e,t){(0,i.assertStruct)(e,m,"Invalid JSON-RPC request",t)}const _=(0,n.object)({id:d,jsonrpc:f,result:(0,n.optional)((0,n.unknown)()),error:(0,n.optional)(h)}),S=(0,n.object)({id:d,jsonrpc:f,result:o}),E=(0,n.object)({id:d,jsonrpc:f,error:h}),x=(0,n.union)([S,E]);function A(e){return(0,n.is)(e,_)}function k(e,t){(0,i.assertStruct)(e,_,"Invalid pending JSON-RPC response",t)}function M(e){return(0,n.is)(e,x)}function T(e,t){(0,i.assertStruct)(e,x,"Invalid JSON-RPC response",t)}function O(e){return(0,n.is)(e,S)}function R(e,t){(0,i.assertStruct)(e,S,"Invalid JSON-RPC success response",t)}function P(e){return(0,n.is)(e,E)}function C(e,t){(0,i.assertStruct)(e,E,"Invalid JSON-RPC failure response",t)}function I(e){return(0,n.is)(e,h)}function j(e,t){(0,i.assertStruct)(e,h,"Invalid JSON-RPC error",t)}function N(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)}},{"./assert":12,superstruct:601}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{createProjectLogger:function(){return s},createModuleLogger:function(){return o}});function n(e){return e&&e.__esModule?e:{default:e}}const i=(0,n(e("debug")).default)("metamask");function s(e){return i.extend(e)}function o(e,t){return e.extend(t)}},{debug:382}],25:[function(e,t,r){"use strict";function n(e){return Array.isArray(e)&&e.length>0}function i(e){return null==e}function s(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)}Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{JsonSize:function(){return u},isNonEmptyArray:function(){return n},isNullOrUndefined:function(){return i},isObject:function(){return s},hasProperty:function(){return o},getKnownPropertyNames:function(){return a},ESCAPE_CHARACTERS_REGEXP:function(){return c},isPlainObject:function(){return l},isASCII:function(){return f},calculateStringSize:function(){return d},calculateNumberSize:function(){return h}});const o=(e,t)=>Object.hasOwnProperty.call(e,t);function a(e){return Object.getOwnPropertyNames(e)}var u;!function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(u||(u={}));const c=/"|\\|\n|\r|\t/gu;function l(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}}function f(e){return e.charCodeAt(0)<=127}function d(e){return e.split("").reduce(((e,t)=>f(t)?e+1:e+2),0)+(e.match(c)??[]).length}function h(e){return e.toString().length}},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{numberToHex:function(){return s},bigIntToHex:function(){return o},hexToNumber:function(){return a},hexToBigInt:function(){return u}});const n=e("./assert"),i=e("./hex"),s=e=>((0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,i.add0x)(e.toString(16))),o=e=>((0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=0,"Value must be a non-negative bigint."),(0,i.add0x)(e.toString(16))),a=e=>{(0,i.assertIsHexString)(e);const t=parseInt(e,16);return(0,n.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t},u=e=>((0,i.assertIsHexString)(e),BigInt((0,i.add0x)(e)))},{"./assert":12,"./hex":20}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],28:[function(e,t,r){"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{Duration:function(){return n},inMilliseconds:function(){return s},timeSince:function(){return o}}),function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(n||(n={}));const i=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};function s(e,t){return i(e,"count"),e*t}function o(e){return i(e,"timestamp"),Date.now()-e}},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{VersionStruct:function(){return o},VersionRangeStruct:function(){return a},isValidSemVerVersion:function(){return u},isValidSemVerRange:function(){return c},assertIsSemVerVersion:function(){return l},assertIsSemVerRange:function(){return f},gtVersion:function(){return d},gtRange:function(){return h},satisfiesVersionRange:function(){return p}});const n=e("semver"),i=e("superstruct"),s=e("./assert"),o=(0,i.refine)((0,i.string)(),"Version",(e=>null!==(0,n.valid)(e)||`Expected SemVer version, got "${e}"`)),a=(0,i.refine)((0,i.string)(),"Version range",(e=>null!==(0,n.validRange)(e)||`Expected SemVer range, got "${e}"`));function u(e){return(0,i.is)(e,o)}function c(e){return(0,i.is)(e,a)}function l(e){(0,s.assertStruct)(e,o)}function f(e){(0,s.assertStruct)(e,a)}function d(e,t){return(0,n.gt)(e,t)}function h(e,t){return(0,n.gtr)(e,t)}function p(e,t){return(0,n.satisfies)(e,t,{includePrerelease:!0})}},{"./assert":12,semver:557,superstruct:601}],31:[function(e,t,r){"use strict";var n,i,s,o,a,u,c,l,f,d,h,p,m,g=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},b=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},y=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.JsonRpcEngine=void 0;const v=e("@metamask/rpc-errors"),w=y(e("@metamask/safe-event-emitter")),_=e("@metamask/utils");class S extends w.default{constructor({notificationHandler:e}={}){super(),n.add(this),s.set(this,!1),o.set(this,void 0),a.set(this,void 0),g(this,o,[],"f"),g(this,a,e,"f")}destroy(){b(this,o,"f").forEach((e=>{"destroy"in e&&"function"==typeof e.destroy&&e.destroy()})),g(this,o,[],"f"),g(this,s,!0,"f")}push(e){b(this,n,"m",u).call(this),b(this,o,"f").push(e)}handle(e,t){if(b(this,n,"m",u).call(this),t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?b(this,n,"m",c).call(this,e,t):b(this,n,"m",c).call(this,e):t?b(this,n,"m",l).call(this,e,t):this._promiseHandle(e)}asMiddleware(){return b(this,n,"m",u).call(this),async(e,t,r,n)=>{try{const[s,a,u]=await b(S,i,"m",d).call(S,e,t,b(this,o,"f"));return a?(await b(S,i,"m",p).call(S,u),n(s)):r((async e=>{try{await b(S,i,"m",p).call(S,u)}catch(t){return e(t)}return e()}))}catch(e){return n(e)}}}async _promiseHandle(e){return new Promise(((t,r)=>{b(this,n,"m",l).call(this,e,((e,n)=>{e&&void 0===n&&r(e),t(n)})).catch(r)}))}}function E(e){return JSON.stringify(e,null,2)}r.JsonRpcEngine=S,i=S,s=new WeakMap,o=new WeakMap,a=new WeakMap,n=new WeakSet,u=function(){if(b(this,s,"f"))throw new Error("This engine is destroyed and can no longer be used.")},c=async function(e,t){try{if(0===e.length){const e=[{id:null,jsonrpc:"2.0",error:new v.JsonRpcError(v.errorCodes.rpc.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return t?t(null,e):e}const r=(await Promise.all(e.map(this._promiseHandle.bind(this)))).filter((e=>void 0!==e));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}},l=async function(e,t){if(!e||Array.isArray(e)||"object"!=typeof e){const r=new v.JsonRpcError(v.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:null,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const r=new v.JsonRpcError(v.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return b(this,a,"f")&&!(0,_.isJsonRpcRequest)(e)?t(null):t(r,{id:e.id??null,jsonrpc:"2.0",error:r})}if(b(this,a,"f")&&!(0,_.isJsonRpcRequest)(e)){try{await b(this,a,"f").call(this,e)}catch(r){return t(r)}return t(null)}let r=null;const n={...e},s={id:n.id,jsonrpc:n.jsonrpc};try{await b(S,i,"m",f).call(S,n,s,b(this,o,"f"))}catch(e){r=e}return r&&(delete s.result,s.error||(s.error=(0,v.serializeError)(r))),t(r,s)},f=async function(e,t,r){const[n,s,o]=await b(S,i,"m",d).call(S,e,t,r);if(b(S,i,"m",m).call(S,e,t,s),await b(S,i,"m",p).call(S,o),n)throw n},d=async function(e,t,r){const n=[];let s=null,o=!1;for(const a of r)if([s,o]=await b(S,i,"m",h).call(S,e,t,a,n),o)break;return[s,o,n.reverse()]},h=async function(e,t,r,n){return new Promise((i=>{const s=e=>{const r=e||t.error;r&&(t.error=(0,v.serializeError)(r)),i([r,!0])},o=r=>{t.error?s(t.error):(r&&("function"!=typeof r&&s(new v.JsonRpcError(v.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${E(e)}`,{request:e})),n.push(r)),i([null,!1]))};try{r(e,t,o,s)}catch(e){s(e)}}))},p=async function(e){for(const t of e)await new Promise(((e,r)=>{t((t=>t?r(t):e()))}))},m=function(e,t,r){if(!(0,_.hasProperty)(t,"result")&&!(0,_.hasProperty)(t,"error"))throw new v.JsonRpcError(v.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${E(e)}`,{request:e});if(!r)throw new v.JsonRpcError(v.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${E(e)}`,{request:e})}},{"@metamask/rpc-errors":147,"@metamask/safe-event-emitter":38,"@metamask/utils":48}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createAsyncMiddleware=void 0,r.createAsyncMiddleware=function(e){return async(t,r,n,i)=>{let s;const o=new Promise((e=>{s=e}));let a=null,u=!1;const c=async()=>{u=!0,n((e=>{a=e,s()})),await o};try{await e(t,r,c),u?(await o,a(null)):i(null)}catch(e){a?a(e):i(e)}}}},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createScaffoldMiddleware=void 0,r.createScaffoldMiddleware=function(e){return(t,r,n,i)=>{const s=e[t.method];return void 0===s?n():"function"==typeof s?s(t,r,n,i):(r.result=s,i())}}},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getUniqueId=void 0;const n=4294967295;let i=Math.floor(Math.random()*n);r.getUniqueId=function(){return i=(i+1)%n,i}},{}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createIdRemapMiddleware=void 0;const n=e("./getUniqueId");r.createIdRemapMiddleware=function(){return(e,t,r,i)=>{const s=e.id,o=(0,n.getUniqueId)();e.id=o,t.id=o,r((r=>{e.id=s,t.id=s,r()}))}}},{"./getUniqueId":34}],36:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./createAsyncMiddleware"),r),i(e("./createScaffoldMiddleware"),r),i(e("./getUniqueId"),r),i(e("./idRemapMiddleware"),r),i(e("./JsonRpcEngine"),r),i(e("./mergeMiddleware"),r)},{"./JsonRpcEngine":31,"./createAsyncMiddleware":32,"./createScaffoldMiddleware":33,"./getUniqueId":34,"./idRemapMiddleware":35,"./mergeMiddleware":37}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mergeMiddleware=void 0;const n=e("./JsonRpcEngine");r.mergeMiddleware=function(e){const t=new n.JsonRpcEngine;return e.forEach((e=>t.push(e))),t.asMiddleware()}},{"./JsonRpcEngine":31}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e("events");function i(e,t,r){try{Reflect.apply(e,t,r)}catch(e){setTimeout((()=>{throw e}))}}class s extends n.EventEmitter{emit(e,...t){let r="error"===e;const n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){let e;if(t.length>0&&([e]=t),e instanceof Error)throw e;const r=new Error("Unhandled error."+(e?` (${e.message})`:""));throw r.context=e,r}const s=n[e];if(void 0===s)return!1;if("function"==typeof s)i(s,this,t);else{const e=s.length,r=function(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}(s);for(let n=0;n<e;n+=1)i(r[n],this,t)}return!0}}r.default=s},{events:421}],39:[function(e,t,r){arguments[4][12][0].apply(r,arguments)},{dup:12,superstruct:601}],40:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"./assert":39,dup:13,superstruct:601}],41:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{isBytes:function(){return c},assertIsBytes:function(){return l},bytesToHex:function(){return f},bytesToBigInt:function(){return d},bytesToSignedBigInt:function(){return h},bytesToNumber:function(){return p},bytesToString:function(){return m},hexToBytes:function(){return g},bigIntToBytes:function(){return b},signedBigIntToBytes:function(){return y},numberToBytes:function(){return v},stringToBytes:function(){return w},valueToBytes:function(){return _},concatBytes:function(){return S},createDataView:function(){return E}});const n=e("./assert"),i=e("./hex"),s=48,o=58,a=87;const u=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function c(e){return e instanceof Uint8Array}function l(e){(0,n.assert)(c(e),"Value must be a Uint8Array.")}function f(e){if(l(e),0===e.length)return"0x";const t=u(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,i.add0x)(r.join(""))}function d(e){l(e);const t=f(e);return BigInt(t)}function h(e){l(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)}function p(e){l(e);const t=d(e);return(0,n.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)}function m(e){return l(e),(new TextDecoder).decode(e)}function g(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,i.assertIsHexString)(e);const t=(0,i.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),i=r.charCodeAt(2*e+1),u=t-(t<o?s:a),c=i-(i<o?s:a);n[e]=16*u+c}return n}function b(e){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return g(e.toString(16))}function y(e,t){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)("number"==typeof t,"Byte length must be a number."),(0,n.assert)(t>0,"Byte length must be greater than 0."),(0,n.assert)(function(e,t){(0,n.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const i=new Uint8Array(t);for(let e=0;e<i.length;e++)i[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return i.reverse()}function v(e){(0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return g(e.toString(16))}function w(e){return(0,n.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function _(e){if("bigint"==typeof e)return b(e);if("number"==typeof e)return v(e);if("string"==typeof e)return e.startsWith("0x")?g(e):w(e);if(c(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}function S(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const i=_(e[n]);t[n]=i,r+=i.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n}function E(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)},{"./assert":39,"./hex":47,buffer:365}],42:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{dup:15,superstruct:601}],43:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{"./base64":40,dup:16,superstruct:601}],44:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./assert":39,"./bytes":41,"./hex":47,dup:17,superstruct:601}],45:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18}],46:[function(e,t,r){arguments[4][19][0].apply(r,arguments)},{dup:19}],47:[function(e,t,r){arguments[4][20][0].apply(r,arguments)},{"./assert":39,"./bytes":41,"@noble/hashes/sha3":321,dup:20,superstruct:601}],48:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{"./assert":39,"./base64":40,"./bytes":41,"./caip-types":42,"./checksum":43,"./coercers":44,"./collections":45,"./encryption-types":46,"./hex":47,"./json":49,"./keyring":50,"./logging":51,"./misc":52,"./number":53,"./opaque":54,"./time":55,"./transaction-types":56,"./versions":57,dup:21}],49:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{"./assert":39,dup:22,superstruct:601}],50:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{dup:23}],51:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{debug:382,dup:24}],52:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{dup:25}],53:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{"./assert":39,"./hex":47,dup:26}],54:[function(e,t,r){arguments[4][27][0].apply(r,arguments)},{dup:27}],55:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],56:[function(e,t,r){arguments[4][29][0].apply(r,arguments)},{dup:29}],57:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{"./assert":39,dup:30,semver:557,superstruct:601}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{BIP_44_COIN_TYPE_DEPTH:function(){return h},BIP44CoinTypeNode:function(){return m},deriveBIP44AddressKey:function(){return y},getBIP44AddressKeyDeriver:function(){return v}});const n=e("@metamask/utils"),i=e("./BIP44Node"),s=e("./constants"),o=e("./SLIP10Node"),a=e("./utils");function u(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function c(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,u(e,t,"get"))}function l(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function f(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,u(e,t,"set"),r),r}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h=2;var p=new WeakMap;class m{static async fromJSON(e,t){b(t),g(e.depth);const r=await i.BIP44Node.fromExtendedKey({depth:e.depth,index:e.index,parentFingerprint:e.parentFingerprint,chainCode:(0,a.hexStringToBytes)(e.chainCode),privateKey:(0,a.nullableHexStringToBytes)(e.privateKey),publicKey:(0,a.hexStringToBytes)(e.publicKey)});return new m(r,t)}static async fromDerivationPath(e){g(e.length-1);const t=await i.BIP44Node.fromDerivationPath({derivationPath:e}),r=e[h].split(":")[1]?.replace("'","");(0,n.assert)(r,"Invalid derivation path.");const s=Number.parseInt(r,10);return new m(t,s)}static async fromNode(e,t){if(!(e instanceof i.BIP44Node))throw new Error("Invalid node: Expected an instance of BIP44Node.");return b(t),g(e.depth),Promise.resolve(new m(e,t))}get depth(){return c(this,p).depth}get privateKeyBytes(){return c(this,p).privateKeyBytes}get publicKeyBytes(){return c(this,p).publicKeyBytes}get chainCodeBytes(){return c(this,p).chainCodeBytes}get privateKey(){return c(this,p).privateKey}get publicKey(){return c(this,p).publicKey}get compressedPublicKey(){return c(this,p).compressedPublicKey}get compressedPublicKeyBytes(){return c(this,p).compressedPublicKeyBytes}get chainCode(){return c(this,p).chainCode}get address(){return c(this,p).address}get masterFingerprint(){return c(this,p).masterFingerprint}get parentFingerprint(){return c(this,p).parentFingerprint}get fingerprint(){return c(this,p).fingerprint}get index(){return c(this,p).index}get curve(){return c(this,p).curve}get extendedKey(){return c(this,p).extendedKey}async deriveBIP44AddressKey({account:e=0,change:t=0,address_index:r}){return await c(this,p).derive((0,a.getBIP44CoinTypeToAddressPathTuple)({account:e,change:t,address_index:r}))}toJSON(){return{...c(this,p).toJSON(),coin_type:this.coin_type,path:this.path}}constructor(e,t){l(this,p,{writable:!0,value:void 0}),d(this,"path",void 0),d(this,"coin_type",void 0),f(this,p,e),this.coin_type=t,this.path=(0,a.getBIP44CoinTypePathString)(t),Object.freeze(this)}}function g(e){if(e!==h)throw new Error(`Invalid depth: Coin type nodes must be of depth ${h}. Received: "${e}"`)}function b(e){if("number"!=typeof e||!Number.isInteger(e)||e<0)throw new Error("Invalid coin type: The specified coin type must be a non-negative integer number.")}async function y(e,{account:t=0,change:r=0,address_index:n}){const s=(0,a.getBIP44CoinTypeToAddressPathTuple)({account:t,change:r,address_index:n}),u=await w(e),c=await(0,o.deriveChildNode)({path:s,node:u});return new i.BIP44Node(c)}async function v(e,t){const{account:r=0,change:n=0}=t??{},s=await w(e),u=(0,a.getHardenedBIP32NodeToken)(r),c=(0,a.getBIP32NodeToken)(n),l=async(e,t=!1)=>{const r=await(0,o.deriveChildNode)({path:[u,c,t?(0,a.getHardenedBIP32NodeToken)(e):(0,a.getUnhardenedBIP32NodeToken)(e)],node:s});return new i.BIP44Node(r)};return l.coin_type=s.coin_type,l.path=(0,a.getBIP44ChangePathString)(s.path,{account:r,change:n}),Object.freeze(l),l}async function w(e){if(e instanceof m)return g(e.depth),e;if("string"==typeof e){const t=await i.BIP44Node.fromExtendedKey(e),r=await m.fromNode(t,t.index-s.BIP_32_HARDENED_OFFSET);return g(r.depth),r}return m.fromJSON(e,e.coin_type)}},{"./BIP44Node":59,"./SLIP10Node":60,"./constants":61,"./utils":74,"@metamask/utils":83}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{BIP44Node:function(){return h},validateBIP44Depth:function(){return p}});const n=e("@metamask/utils"),i=e("./constants"),s=e("./extended-keys"),o=e("./SLIP10Node"),a=e("./utils");function u(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function c(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,u(e,t,"get"))}function l(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function f(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,u(e,t,"set"),r),r}var d=new WeakMap;class h{static async fromJSON(e){return h.fromExtendedKey(e)}static async fromExtendedKey(e){if("string"==typeof e){const t=(0,s.decodeExtendedKey)(e),{chainCode:r,depth:n,parentFingerprint:i,index:o}=t;if(t.version===s.PRIVATE_KEY_VERSION){const{privateKey:e}=t;return h.fromExtendedKey({depth:n,parentFingerprint:i,index:o,privateKey:e,chainCode:r})}const{publicKey:a}=t;return h.fromExtendedKey({depth:n,parentFingerprint:i,index:o,publicKey:a,chainCode:r})}const{privateKey:t,publicKey:r,chainCode:n,depth:i,parentFingerprint:a,index:u}=e;p(i);const c=await o.SLIP10Node.fromExtendedKey({privateKey:t,publicKey:r,chainCode:n,depth:i,parentFingerprint:a,index:u,curve:"secp256k1"});return new h(c)}static async fromDerivationPath({derivationPath:e}){p(e.length-1),m(e,i.MIN_BIP_44_DEPTH);const t=await o.SLIP10Node.fromDerivationPath({derivationPath:e,curve:"secp256k1"});return new h(t)}get depth(){return c(this,d).depth}get privateKeyBytes(){return c(this,d).privateKeyBytes}get publicKeyBytes(){return c(this,d).publicKeyBytes}get chainCodeBytes(){return c(this,d).chainCodeBytes}get privateKey(){return c(this,d).privateKey}get publicKey(){return c(this,d).publicKey}get compressedPublicKey(){return c(this,d).compressedPublicKey}get compressedPublicKeyBytes(){return c(this,d).compressedPublicKeyBytes}get chainCode(){return c(this,d).chainCode}get address(){return c(this,d).address}get masterFingerprint(){return c(this,d).masterFingerprint}get parentFingerprint(){return c(this,d).parentFingerprint}get fingerprint(){return c(this,d).fingerprint}get index(){return c(this,d).index}get extendedKey(){const e={depth:this.depth,parentFingerprint:this.parentFingerprint,index:this.index,chainCode:this.chainCodeBytes};return this.privateKeyBytes?(0,s.encodeExtendedKey)({...e,version:s.PRIVATE_KEY_VERSION,privateKey:this.privateKeyBytes}):(0,s.encodeExtendedKey)({...e,version:s.PUBLIC_KEY_VERSION,publicKey:this.publicKeyBytes})}get curve(){return c(this,d).curve}neuter(){const e=c(this,d).neuter();return new h(e)}async derive(e){if(this.depth===i.MAX_BIP_44_DEPTH)throw new Error("Illegal operation: This HD tree node is already a leaf node.");p(this.depth+e.length),m(e,this.depth+1);const t=await c(this,d).derive(e);return new h(t)}toJSON(){return{depth:this.depth,masterFingerprint:this.masterFingerprint,parentFingerprint:this.parentFingerprint,index:this.index,privateKey:this.privateKey,publicKey:this.publicKey,chainCode:this.chainCode}}constructor(e){l(this,d,{writable:!0,value:void 0}),f(this,d,e),Object.freeze(this)}}function p(e){if((0,o.validateBIP32Depth)(e),e<i.MIN_BIP_44_DEPTH||e>i.MAX_BIP_44_DEPTH)throw new Error(`Invalid HD tree path depth: The depth must be a positive integer N such that 0 <= N <= 5. Received: "${e}"`)}function m(e,t){e.forEach(((e,r)=>{const s=t+r;if(s!==i.MIN_BIP_44_DEPTH)switch((0,n.assert)("string"==typeof e),s){case 1:if(e!==i.BIP44PurposeNodeToken)throw new Error(`Invalid derivation path: The "purpose" node (depth 1) must be the string "${i.BIP44PurposeNodeToken}".`);break;case 2:if(!i.BIP_32_PATH_REGEX.test(e)||!(0,a.isHardened)(e))throw new Error('Invalid derivation path: The "coin_type" node (depth 2) must be a hardened BIP-32 node.');break;case 3:if(!i.BIP_32_PATH_REGEX.test(e)||!(0,a.isHardened)(e))throw new Error('Invalid derivation path: The "account" node (depth 3) must be a hardened BIP-32 node.');break;case 4:if(!i.BIP_32_PATH_REGEX.test(e))throw new Error('Invalid derivation path: The "change" node (depth 4) must be a BIP-32 node.');break;case i.MAX_BIP_44_DEPTH:if(!i.BIP_32_PATH_REGEX.test(e))throw new Error('Invalid derivation path: The "address_index" node (depth 5) must be a BIP-32 node.')}else if(!(e instanceof Uint8Array||i.BIP_39_PATH_REGEX.test(e)))throw new Error('Invalid derivation path: The "m" / seed node (depth 0) must be a BIP-39 node.')}))}},{"./SLIP10Node":60,"./constants":61,"./extended-keys":72,"./utils":74,"@metamask/utils":83}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{SLIP10Node:function(){return f},validateBIP32Depth:function(){return h},validateParentFingerprint:function(){return p},validateMasterParentFingerprint:function(){return m},validateRootIndex:function(){return g},deriveChildNode:function(){return b}});const n=e("@metamask/utils"),i=e("./constants"),s=e("./curves"),o=e("./derivation"),a=e("./derivers/bip32"),u=e("./utils");function c(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}(r,"get"),function(e,t){return t.get?t.get.call(e):t.value}(e,r)}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f{static async fromJSON(e){return f.fromExtendedKey(e)}static async fromExtendedKey({depth:e,masterFingerprint:t,parentFingerprint:r,index:o,privateKey:a,publicKey:l,chainCode:b,curve:y}){const v=(0,u.getBytes)(b,i.BYTES_KEY_LENGTH);(0,u.validateCurve)(y),h(e),(0,u.validateBIP32Index)(o),g(o,e),p(r,e),m(t,r,e);const w=(0,s.getCurveByName)(y);if(a){const s=(0,u.getBytesUnsafe)(a,i.BYTES_KEY_LENGTH);return(0,n.assert)(w.isValidPrivateKey(s),`Invalid private key: Value is not a valid ${y} private key.`),new f({depth:e,masterFingerprint:t,parentFingerprint:r,index:o,chainCode:v,privateKey:s,publicKey:await w.getPublicKey(s),curve:y},c(this,f,d))}if(l){const n=(0,u.getBytes)(l,w.publicKeyLength);return new f({depth:e,masterFingerprint:t,parentFingerprint:r,index:o,chainCode:v,publicKey:n,curve:y},c(this,f,d))}throw new Error("Invalid options: Must provide either a private key or a public key.")}static async fromDerivationPath({derivationPath:e,curve:t}){if((0,u.validateCurve)(t),!e)throw new Error("Invalid options: Must provide a derivation path.");if(0===e.length)throw new Error("Invalid derivation path: May not specify an empty derivation path.");return await(0,o.deriveKeyFromPath)({path:e,depth:e.length-1,curve:t})}get chainCode(){return(0,n.bytesToHex)(this.chainCodeBytes)}get privateKey(){if(this.privateKeyBytes)return(0,n.bytesToHex)(this.privateKeyBytes)}get publicKey(){return(0,n.bytesToHex)(this.publicKeyBytes)}get compressedPublicKeyBytes(){return(0,s.getCurveByName)(this.curve).compressPublicKey(this.publicKeyBytes)}get compressedPublicKey(){return(0,n.bytesToHex)(this.compressedPublicKeyBytes)}get address(){if("secp256k1"!==this.curve)throw new Error("Unable to get address for this node: Only secp256k1 is supported.");return(0,n.bytesToHex)((0,a.publicKeyToEthAddress)(this.publicKeyBytes))}get fingerprint(){return(0,u.getFingerprint)(this.compressedPublicKeyBytes)}neuter(){return new f({depth:this.depth,masterFingerprint:this.masterFingerprint,parentFingerprint:this.parentFingerprint,index:this.index,chainCode:this.chainCodeBytes,publicKey:this.publicKeyBytes,curve:this.curve},c(f,f,d))}async derive(e){return await b({path:e,node:this})}toJSON(){return{depth:this.depth,masterFingerprint:this.masterFingerprint,parentFingerprint:this.parentFingerprint,index:this.index,curve:this.curve,privateKey:this.privateKey,publicKey:this.publicKey,chainCode:this.chainCode}}constructor({depth:e,masterFingerprint:t,parentFingerprint:r,index:i,chainCode:s,privateKey:o,publicKey:a,curve:u},h){l(this,"curve",void 0),l(this,"depth",void 0),l(this,"masterFingerprint",void 0),l(this,"parentFingerprint",void 0),l(this,"index",void 0),l(this,"chainCodeBytes",void 0),l(this,"privateKeyBytes",void 0),l(this,"publicKeyBytes",void 0),(0,n.assert)(h===c(f,f,d),"SLIP10Node can only be constructed using `SLIP10Node.fromJSON`, `SLIP10Node.fromExtendedKey`, or `SLIP10Node.fromDerivationPath`."),this.depth=e,this.masterFingerprint=t,this.parentFingerprint=r,this.index=i,this.chainCodeBytes=s,this.privateKeyBytes=o,this.publicKeyBytes=a,this.curve=u,Object.freeze(this)}}var d={writable:!0,value:Symbol("SLIP10Node.constructor")};function h(e){if(!(0,u.isValidInteger)(e))throw new Error(`Invalid HD tree path depth: The depth must be a positive integer. Received: "${String(e)}".`)}function p(e,t){if(!(0,u.isValidInteger)(e))throw new Error(`Invalid parent fingerprint: The fingerprint must be a positive integer. Received: "${String(e)}".`);if(0===t&&0!==e)throw new Error(`Invalid parent fingerprint: The fingerprint of the root node must be 0. Received: "${String(e)}".`);if(t>0&&0===e)throw new Error(`Invalid parent fingerprint: The fingerprint of a child node must not be 0. Received: "${String(e)}".`)}function m(e,t,r){if(e&&r>=2&&e===t)throw new Error(`Invalid parent fingerprint: The fingerprint of a child node cannot be equal to the master fingerprint. Received: "${String(t)}".`)}function g(e,t){if(0===t&&0!==e)throw new Error(`Invalid index: The index of the root node must be 0. Received: "${String(e)}".`)}async function b({path:e,node:t}){if(0===e.length)throw new Error("Invalid HD tree derivation path: Deriving a path of length 0 is not defined.");const r=t.depth+e.length;return h(r),await(0,o.deriveKeyFromPath)({path:e,node:t,depth:r})}},{"./constants":61,"./curves":64,"./derivation":66,"./derivers/bip32":67,"./utils":74,"@metamask/utils":83}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{BYTES_KEY_LENGTH:function(){return n},MIN_BIP_44_DEPTH:function(){return i},MAX_BIP_44_DEPTH:function(){return s},MAX_UNHARDENED_BIP_32_INDEX:function(){return o},MAX_BIP_32_INDEX:function(){return a},BIP44PurposeNodeToken:function(){return u},UNPREFIXED_PATH_REGEX:function(){return c},UNPREFIXED_BIP_32_PATH_REGEX:function(){return l},BIP_32_PATH_REGEX:function(){return f},SLIP_10_PATH_REGEX:function(){return d},BIP_39_PATH_REGEX:function(){return h},BIP_32_HARDENED_OFFSET:function(){return p}});const n=32,i=0,s=5,o=2147483647,a=4294967295,u="bip32:44'",c=/^\d+$/u,l=RegExp("^(?<index>\\d+)'?$","u"),f=/^bip32:\d+'?$/u,d=/^slip10:\d+'?$/u,h=/^bip39:([a-z]+){1}( [a-z]+){11,23}$/u,p=2147483648},{}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{curves:function(){return a},getCurveByName:function(){return u},mod:function(){return c}});const n=e("@noble/secp256k1"),i=o(e("./ed25519"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}const a={secp256k1:o(e("./secp256k1")),ed25519:i};function u(e){return a[e]}const{mod:c}=n.utils},{"./ed25519":63,"./secp256k1":65,"@noble/secp256k1":324}],63:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{curve:function(){return i.CURVE},name:function(){return s},secret:function(){return o},isValidPrivateKey:function(){return a},deriveUnhardenedKeys:function(){return u},publicKeyLength:function(){return c},getPublicKey:function(){return l},publicAdd:function(){return f},compressPublicKey:function(){return d},decompressPublicKey:function(){return h}});const n=e("@metamask/utils"),i=e("@noble/ed25519"),s="ed25519",o=(0,n.stringToBytes)("ed25519 seed"),a=e=>!0,u=!1,c=33,l=async(e,t)=>{const r=await(0,i.getPublicKey)(e);return(0,n.concatBytes)([new Uint8Array([0]),r])},f=(e,t)=>{throw new Error("Ed25519 does not support public key derivation.")},d=e=>e,h=e=>e},{"@metamask/utils":83,"@noble/ed25519":313}],64:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{secp256k1:function(){return s},ed25519:function(){return o}}),n=e("./curve"),i=r,Object.keys(n).forEach((function(e){"default"===e||Object.prototype.hasOwnProperty.call(i,e)||Object.defineProperty(i,e,{enumerable:!0,get:function(){return n[e]}})}));const s=u(e("./secp256k1")),o=u(e("./ed25519"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function u(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=i?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(n,s,o):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}},{"./curve":62,"./ed25519":63,"./secp256k1":65}],65:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{curve:function(){return i.CURVE},name:function(){return o},secret:function(){return a},deriveUnhardenedKeys:function(){return u},publicKeyLength:function(){return c},isValidPrivateKey:function(){return l},getPublicKey:function(){return f},publicAdd:function(){return d},compressPublicKey:function(){return h},decompressPublicKey:function(){return p}});const n=e("@metamask/utils"),i=e("@noble/secp256k1"),s=e("../utils"),o="secp256k1",a=(0,n.stringToBytes)("Bitcoin seed"),u=!0,c=65,l=e=>i.utils.isValidPrivateKey(e),f=(e,t)=>(0,i.getPublicKey)(e,t),d=(e,t)=>{(0,n.assert)((0,s.isValidBytesKey)(t,32),"Invalid tweak: Tweak must be a non-zero 32-byte Uint8Array.");const r=i.Point.fromHex(e).add(i.Point.fromPrivateKey(t));return r.assertValidity(),r.toRawBytes(!1)},h=e=>i.Point.fromHex(e).toRawBytes(!0),p=e=>i.Point.fromHex(e).toRawBytes(!1)},{"../utils":74,"@metamask/utils":83,"@noble/secp256k1":324}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{deriveKeyFromPath:function(){return l},validatePathSegment:function(){return f}});const n=e("@metamask/utils"),i=e("./BIP44CoinTypeNode"),s=e("./BIP44Node"),o=e("./constants"),a=e("./curves"),u=e("./derivers"),c=e("./SLIP10Node");async function l(e){const{path:t,depth:r=t.length}=e,o="node"in e?e.node:void 0,l="curve"in e?e.curve:o?.curve;if(o&&!(o instanceof c.SLIP10Node)&&!(o instanceof s.BIP44Node)&&!(o instanceof i.BIP44CoinTypeNode))throw new Error("Invalid arguments: Node must be a SLIP-10 node or a BIP-44 node when provided.");if(!l)throw new Error("Invalid arguments: Must specify either a parent node or curve.");return f(t,Boolean(o?.privateKey)||Boolean(o?.publicKey),r),await t.reduce((async(e,t,r)=>{const i=await e;if("string"==typeof t){const[e,r]=t.split(":");(0,n.assert)(e),(0,n.assert)(r),(0,n.assert)(function(e){return e in u.derivers}(e),`Unknown derivation type: "${e}".`);const s=u.derivers[e];return await s.deriveChildKey({path:r,node:i,curve:(0,a.getCurveByName)(l)})}return(0,n.assert)(0===r,d()),await u.derivers.bip39.deriveChildKey({path:t,node:i,curve:(0,a.getCurveByName)(l)})}),Promise.resolve(o))}function f(e,t,r){if(0===e.length)throw new Error("Invalid HD path segment: The segment must not be empty.");let i=!1;if(e.forEach(((e,t)=>{if(0===t){if(i=e instanceof Uint8Array||o.BIP_39_PATH_REGEX.test(e),!(e instanceof Uint8Array||i||o.BIP_32_PATH_REGEX.test(e)||o.SLIP_10_PATH_REGEX.test(e)))throw d()}else if(e instanceof Uint8Array||!o.BIP_32_PATH_REGEX.test(e)&&!o.SLIP_10_PATH_REGEX.test(e))throw d()})),r===o.MIN_BIP_44_DEPTH&&(!i||1!==e.length))throw new Error(`Invalid HD path segment: The segment must consist of a single BIP-39 node for depths of ${o.MIN_BIP_44_DEPTH}. Received: "${String(e)}".`);if(!t&&!i)throw new Error("Invalid derivation parameters: Must specify parent key if the first node of the path segment is not a BIP-39 node.");if(t&&i)throw new Error("Invalid derivation parameters: May not specify parent key if the path segment starts with a BIP-39 node.");const s=i?e.slice(1):e;if(s.length>0){const e=s[0]?.split(":")[0];(0,n.assert)(e),(0,n.assert)(s.every((t=>t.startsWith(`${e}:`))),"Invalid HD path segment: Cannot mix 'bip32' and 'slip10' path segments.")}}function d(){return new Error("Invalid HD path segment: The path segment is malformed.")}},{"./BIP44CoinTypeNode":58,"./BIP44Node":59,"./SLIP10Node":60,"./constants":61,"./curves":64,"./derivers":69,"@metamask/utils":83}],67:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{privateKeyToEthAddress:function(){return c},publicKeyToEthAddress:function(){return l},deriveChildKey:function(){return f}});const n=e("@metamask/utils"),i=e("@noble/hashes/sha3"),s=e("../constants"),o=e("../curves"),a=e("../utils"),u=e("./shared");function c(e){(0,n.assert)(e instanceof Uint8Array&&(0,a.isValidBytesKey)(e,s.BYTES_KEY_LENGTH),"Invalid key: The key must be a 32-byte, non-zero Uint8Array.");return l(o.secp256k1.getPublicKey(e,!1))}function l(e){return(0,n.assert)(e instanceof Uint8Array&&(0,a.isValidBytesKey)(e,o.secp256k1.publicKeyLength),"Invalid key: The key must be a 65-byte, non-zero Uint8Array."),(0,i.keccak_256)(e.slice(1)).slice(-20)}async function f(e){return(0,n.assert)("secp256k1"===e.curve.name,"Invalid curve: Only secp256k1 is supported by BIP-32."),(0,u.deriveChildKey)(e,d)}async function d(e,t){const{childIndex:r,privateKey:n,publicKey:i,isHardened:s,curve:o,chainCode:c}=t;if((0,a.validateBIP32Index)(r+1),n){const e=await(0,u.deriveSecretExtension)({privateKey:n,childIndex:r+1,isHardened:s,curve:o}),i=(0,u.generateEntropy)({chainCode:c,extension:e});return{...t,childIndex:r+1,entropy:i}}const l=(0,u.derivePublicExtension)({parentPublicKey:i,childIndex:r+1}),f=(0,u.generateEntropy)({chainCode:c,extension:l});return{...t,childIndex:r+1,entropy:f}}},{"../constants":61,"../curves":64,"../utils":74,"./shared":70,"@metamask/utils":83,"@noble/hashes/sha3":321}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{bip39MnemonicToMultipath:function(){return f},deriveChildKey:function(){return d},createBip39KeyFromSeed:function(){return h}});const n=e("@metamask/scure-bip39"),i=e("@metamask/scure-bip39/dist/wordlists/english"),s=e("@metamask/utils"),o=e("@noble/hashes/hmac"),a=e("@noble/hashes/sha512"),u=e("../constants"),c=e("../SLIP10Node"),l=e("../utils");function f(e){return`bip39:${e.toLowerCase().trim()}`}async function d({path:e,curve:t}){return h(await(0,n.mnemonicToSeed)(e,i.wordlist),t)}async function h(e,t){(0,s.assert)(e.length>=16&&e.length<=64,"Invalid seed: The seed must be between 16 and 64 bytes long.");const r=(0,o.hmac)(a.sha512,t.secret,e),n=r.slice(0,u.BYTES_KEY_LENGTH),i=r.slice(u.BYTES_KEY_LENGTH);(0,s.assert)(t.isValidPrivateKey(n),"Invalid private key: The private key must greater than 0 and less than the curve order.");const f=(0,l.getFingerprint)(await t.getPublicKey(n,!0));return c.SLIP10Node.fromExtendedKey({privateKey:n,chainCode:i,masterFingerprint:f,depth:0,parentFingerprint:0,index:0,curve:t.name})}},{"../SLIP10Node":60,"../constants":61,"../utils":74,"@metamask/scure-bip39":168,"@metamask/scure-bip39/dist/wordlists/english":169,"@metamask/utils":83,"@noble/hashes/hmac":318,"@noble/hashes/sha512":322}],69:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{derivers:function(){return u},createBip39KeyFromSeed:function(){return i.createBip39KeyFromSeed}});const n=a(e("./bip32")),i=a(e("./bip39")),s=a(e("./slip10"));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=i?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}const u={bip32:n,bip39:i,slip10:s}},{"./bip32":67,"./bip39":68,"./slip10":71}],70:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{deriveChildKey:function(){return l},deriveSecretExtension:function(){return d},derivePublicExtension:function(){return h},derivePublicChildKey:function(){return p},privateAdd:function(){return m},generateEntropy:function(){return g},validateNode:function(){return b}});const n=e("@metamask/utils"),i=e("@noble/hashes/hmac"),s=e("@noble/hashes/sha512"),o=e("../constants"),a=e("../curves"),u=e("../SLIP10Node"),c=e("../utils");async function l({path:e,node:t,curve:r},i){b(t);const{childIndex:s,isHardened:a}=function(e,t,r){!function(e,t,r){(0,n.assert)("string"==typeof e,"Invalid path: Must be a string.");const i=e.endsWith("'");(0,n.assert)(!i||t.privateKey,"Invalid parameters: Cannot derive hardened child keys without a private key."),(0,n.assert)(i||r.deriveUnhardenedKeys,`Invalid path: Cannot derive unhardened child keys with ${r.name}.`)}(e,t,r);const i=e.split("'")[0];(0,n.assert)(i);const s=parseInt(i,10);if(!o.UNPREFIXED_PATH_REGEX.test(i)||!Number.isInteger(s)||s<0||s>=o.BIP_32_HARDENED_OFFSET)throw new Error(`Invalid path: The index must be a non-negative decimal integer less than ${o.BIP_32_HARDENED_OFFSET}.`);return{childIndex:s,isHardened:e.includes("'")}}(e,t,r),u={chainCode:t.chainCodeBytes,childIndex:s,isHardened:a,depth:t.depth,parentFingerprint:t.fingerprint,masterFingerprint:t.masterFingerprint,curve:r};if(t.privateKeyBytes){const e=await d({privateKey:t.privateKeyBytes,childIndex:s,isHardened:a,curve:r}),n=g({chainCode:t.chainCodeBytes,extension:e});return await f({privateKey:t.privateKeyBytes,entropy:n,...u},i)}const c=h({parentPublicKey:t.compressedPublicKeyBytes,childIndex:s}),l=g({chainCode:t.chainCodeBytes,extension:c});return await f({publicKey:t.compressedPublicKeyBytes,entropy:l,...u},i)}async function f(e,t){const{privateKey:r,publicKey:n,entropy:i,childIndex:s,isHardened:a,depth:c,parentFingerprint:l,masterFingerprint:d,curve:h}=e;try{return r?await async function({entropy:e,privateKey:t,depth:r,masterFingerprint:n,parentFingerprint:i,childIndex:s,isHardened:a,curve:c}){const l=s+(a?o.BIP_32_HARDENED_OFFSET:0),{privateKey:f,chainCode:d}=await async function({privateKey:e,entropy:t,curve:r}){const n=t.slice(0,32),i=t.slice(32);if("ed25519"===r.name){return{privateKey:n,publicKey:await r.getPublicKey(n),chainCode:i}}const s=m(e,n,r),o=await r.getPublicKey(s);return{privateKey:s,publicKey:o,chainCode:i}}({privateKey:t,entropy:e,curve:c});return await u.SLIP10Node.fromExtendedKey({privateKey:f,chainCode:d,depth:r+1,masterFingerprint:n,parentFingerprint:i,index:l,curve:c.name})}({entropy:i,privateKey:r,depth:c,masterFingerprint:d,parentFingerprint:l,childIndex:s,isHardened:a,curve:h}):await p({entropy:i,publicKey:n,depth:c,masterFingerprint:d,parentFingerprint:l,childIndex:s,curve:h})}catch(r){return await f(await t(r,e),t)}}async function d({privateKey:e,childIndex:t,isHardened:r,curve:i}){if(r)return(0,n.concatBytes)([new Uint8Array([0]),e,(0,c.numberToUint32)(t+o.BIP_32_HARDENED_OFFSET)]);return h({parentPublicKey:await i.getPublicKey(e,!0),childIndex:t})}function h({parentPublicKey:e,childIndex:t}){return(0,n.concatBytes)([e,(0,c.numberToUint32)(t)])}async function p({entropy:e,publicKey:t,depth:r,masterFingerprint:n,parentFingerprint:i,childIndex:s,curve:o}){const{publicKey:a,chainCode:c}=function({publicKey:e,entropy:t,curve:r}){const n=t.slice(0,32),i=t.slice(32);return{publicKey:r.publicAdd(e,n),chainCode:i}}({publicKey:t,entropy:e,curve:o});return await u.SLIP10Node.fromExtendedKey({publicKey:a,chainCode:c,depth:r+1,masterFingerprint:n,parentFingerprint:i,index:s,curve:o.name})}function m(e,t,r){(0,n.assert)((0,c.isValidBytesKey)(t,32),"Invalid tweak: Tweak must be a non-zero 32-byte Uint8Array.");const i=(0,n.bytesToBigInt)(e),s=(0,n.bytesToBigInt)(t);if(s>=r.curve.n)throw new Error("Invalid tweak: Tweak is larger than the curve order.");const o=(0,a.mod)(i+s,r.curve.n),u=(0,n.hexToBytes)(o.toString(16).padStart(64,"0"));if(!r.isValidPrivateKey(u))throw new Error("Invalid private key or tweak: The resulting private key is invalid.");return u}function g({chainCode:e,extension:t}){return(0,i.hmac)(s.sha512,e,t)}function b(e){(0,n.assert)(e,"Invalid parameters: Must specify a node to derive from.")}},{"../SLIP10Node":60,"../constants":61,"../curves":64,"../utils":74,"@metamask/utils":83,"@noble/hashes/hmac":318,"@noble/hashes/sha512":322}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"deriveChildKey",{enumerable:!0,get:function(){return a}});const n=e("@metamask/utils"),i=e("../constants"),s=e("../utils"),o=e("./shared");async function a(e){return await(0,o.deriveChildKey)(e,u)}async function u(e,t){const{curve:r,isHardened:a,childIndex:u,entropy:c,chainCode:l}=t;if("ed25519"===r.name)throw e;const f=a?u+i.BIP_32_HARDENED_OFFSET:u,d=(0,o.generateEntropy)({chainCode:l,extension:(0,n.concatBytes)([1,c.slice(32,64),(0,s.numberToUint32)(f)])});return{...t,entropy:d}}},{"../constants":61,"../utils":74,"./shared":70,"@metamask/utils":83}],72:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{PUBLIC_KEY_VERSION:function(){return a},PRIVATE_KEY_VERSION:function(){return u},decodeExtendedKey:function(){return c},encodeExtendedKey:function(){return l}});const n=e("@metamask/utils"),i=e("./BIP44Node"),s=e("./curves/secp256k1"),o=e("./utils"),a=76067358,u=76066276,c=e=>{const t=(0,o.decodeBase58check)(e);if(78!==t.length)throw new Error(`Invalid extended key: Expected a length of 78, got ${t.length}.`);const r=(0,n.createDataView)(t),c=r.getUint32(0,!1),l=r.getUint8(4);(0,i.validateBIP44Depth)(l);const f=r.getUint32(5,!1),d=r.getUint32(9,!1),h=t.slice(13,45);if(!(0,o.isValidBytesKey)(h,32))throw new Error("Invalid extended key: Chain code must be a 32-byte non-zero byte array.");const p=t.slice(45,78);if(!(0,o.isValidBytesKey)(p,33))throw new Error("Invalid extended key: Key must be a 33-byte non-zero byte array.");const m=(0,n.createDataView)(p);if(c===a){if(2!==m.getUint8(0)&&3!==m.getUint8(0))throw new Error("Invalid extended key: Public key must start with 0x02 or 0x03.");return{version:c,depth:l,parentFingerprint:f,index:d,chainCode:h,publicKey:(0,s.decompressPublicKey)(p)}}if(c===u){if(0!==m.getUint8(0))throw new Error("Invalid extended key: Private key must start with 0x00.");return{version:c,depth:l,parentFingerprint:f,index:d,chainCode:h,privateKey:p.slice(1)}}throw new Error("Invalid extended key: Expected a public (xpub) or private key (xprv) version.")},l=e=>{const{version:t,depth:r,parentFingerprint:i,index:c,chainCode:l}=e,f=new Uint8Array(78),d=(0,n.createDataView)(f);if(d.setUint32(0,t,!1),d.setUint8(4,r),d.setUint32(5,i,!1),d.setUint32(9,c,!1),f.set(l,13),e.version===a){const{publicKey:t}=e,r=(0,s.compressPublicKey)(t);f.set(r,45)}if(e.version===u){const{privateKey:t}=e;f.set(t,46)}return(0,o.encodeBase58check)(f)}},{"./BIP44Node":59,"./curves/secp256k1":65,"./utils":74,"@metamask/utils":83}],73:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{BIP44Node:function(){return n.BIP44Node},SLIP10Node:function(){return i.SLIP10Node},secp256k1:function(){return s.secp256k1},ed25519:function(){return s.ed25519},BIP44CoinTypeNode:function(){return o.BIP44CoinTypeNode},BIP_44_COIN_TYPE_DEPTH:function(){return o.BIP_44_COIN_TYPE_DEPTH},deriveBIP44AddressKey:function(){return o.deriveBIP44AddressKey},getBIP44AddressKeyDeriver:function(){return o.getBIP44AddressKeyDeriver},isValidBIP32PathSegment:function(){return c.isValidBIP32PathSegment},mnemonicPhraseToBytes:function(){return c.mnemonicPhraseToBytes},createBip39KeyFromSeed:function(){return l.createBip39KeyFromSeed}});const n=e("./BIP44Node"),i=e("./SLIP10Node"),s=e("./curves"),o=e("./BIP44CoinTypeNode");var a,u;a=e("./constants"),u=r,Object.keys(a).forEach((function(e){"default"===e||Object.prototype.hasOwnProperty.call(u,e)||Object.defineProperty(u,e,{enumerable:!0,get:function(){return a[e]}})}));const c=e("./utils"),l=e("./derivers")},{"./BIP44CoinTypeNode":58,"./BIP44Node":59,"./SLIP10Node":60,"./constants":61,"./curves":64,"./derivers":69,"./utils":74}],74:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{getBIP44CoinTypePathString:function(){return l},getBIP44ChangePathString:function(){return f},getBIP44CoinTypeToAddressPathTuple:function(){return d},getHardenedBIP32NodeToken:function(){return h},getUnhardenedBIP32NodeToken:function(){return p},getBIP32NodeToken:function(){return m},validateBIP32Index:function(){return g},isValidBIP32Index:function(){return b},isValidBIP32PathSegment:function(){return y},isHardened:function(){return v},hexStringToBytes:function(){return w},nullableHexStringToBytes:function(){return _},isValidBytesKey:function(){return S},isValidInteger:function(){return E},getBytes:function(){return x},getBytesUnsafe:function(){return A},decodeBase58check:function(){return M},encodeBase58check:function(){return T},getFingerprint:function(){return O},mnemonicPhraseToBytes:function(){return R},validateCurve:function(){return P},numberToUint32:function(){return C}});const n=e("@metamask/scure-bip39/dist/wordlists/english"),i=e("@metamask/utils"),s=e("@noble/hashes/ripemd160"),o=e("@noble/hashes/sha256"),a=e("@scure/base"),u=e("./constants"),c=e("./curves");function l(e){return`m / ${u.BIP44PurposeNodeToken} / ${h(e)}`}function f(e,t){return`${e} / ${h(t.account??0)} / ${m(t.change??0)}`}function d({account:e=0,change:t=0,address_index:r}){return[h(e),m(t),m(r)]}function h(e){return g(e),`${p(e)}'`}function p(e){return g(e),`bip32:${e}`}function m(e){if("number"==typeof e)return p(e);if(!e||!Number.isInteger(e.index)||"boolean"!=typeof e.hardened)throw new Error("Invalid BIP-32 index: Must be an object containing the index and whether it is hardened.");return e.hardened?h(e.index):p(e.index)}function g(e){if(!b(e))throw new Error("Invalid BIP-32 index: Must be a non-negative integer.")}function b(e){return E(e)&&e<=u.MAX_BIP_32_INDEX}function y(e){if("string"!=typeof e)return!1;const t=e.match(u.UNPREFIXED_BIP_32_PATH_REGEX);if(void 0===t?.groups?.index)return!1;const r=parseInt(t.groups.index,10);return E(r)&&r<=u.MAX_UNHARDENED_BIP_32_INDEX}function v(e){return e.endsWith("'")}function w(e){return e instanceof Uint8Array?e:(0,i.hexToBytes)(e)}function _(e){if(void 0!==e)return w(e)}function S(e,t){if(e.length!==t)return!1;for(const t of e)if(0!==t)return!0;return!1}function E(e){return"number"==typeof e&&Number.isInteger(e)&&e>=0}function x(e,t){if(e instanceof Uint8Array)return k(e,t),e;if("string"==typeof e){const r=(0,i.hexToBytes)(e);return k(r,t),r}throw new Error("Invalid value: Expected an instance of Uint8Array or hexadecimal string.")}function A(e,t){if(e instanceof Uint8Array)return(0,i.assert)(e.length===t,`Invalid value: Must be a ${t}-byte byte array.`),e;if("string"==typeof e)return A((0,i.hexToBytes)(e),t);throw new Error("Invalid value: Expected an instance of Uint8Array or hexadecimal string.")}function k(e,t){if(!S(e,t))throw new Error(`Invalid value: Must be a non-zero ${t}-byte byte array.`)}const M=e=>{const t=(0,a.base58check)(o.sha256);try{return t.decode(e)}catch{throw new Error("Invalid extended key: Value is not base58-encoded, or the checksum is invalid.")}},T=e=>(0,a.base58check)(o.sha256).encode(e),O=e=>{if(!S(e,33))throw new Error("Invalid public key: The key must be a 33-byte, non-zero byte array.");const t=(0,s.ripemd160)((0,o.sha256)(e));return(0,i.createDataView)(t).getUint32(0,!1)};function R(e){const t=e.split(" ").map((e=>{const t=n.wordlist.indexOf(e);return(0,i.assert)(-1!==t,`Invalid mnemonic phrase: Unknown word "${e}".`),t}));return new Uint8Array(new Uint16Array(t).buffer)}function P(e){if(!e||"string"!=typeof e)throw new Error("Invalid curve: Must specify a curve.");if(!Object.keys(c.curves).includes(e))throw new Error(`Invalid curve: Only the following curves are supported: ${Object.keys(c.curves).join(", ")}.`)}function C(e){const t=new Uint8Array(4);return(0,i.createDataView)(t).setUint32(0,e,!1),t}},{"./constants":61,"./curves":64,"@metamask/scure-bip39/dist/wordlists/english":169,"@metamask/utils":83,"@noble/hashes/ripemd160":319,"@noble/hashes/sha256":320,"@scure/base":325}],75:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.assertExhaustive=r.assertStruct=r.assert=r.AssertionError=void 0;const n=e("superstruct");function i(e,t){return r=e,Boolean("string"==typeof r?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var r}class s extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}r.AssertionError=s,r.assert=function(e,t="Assertion failed.",r=s){if(!e){if(t instanceof Error)throw t;throw i(r,t)}},r.assertStruct=function(e,t,r="Assertion failed",o=s){try{(0,n.assert)(e,t)}catch(e){throw i(o,`${r}: ${function(e){const t=function(e){return"object"==typeof e&&null!==e&&"message"in e}(e)?e.message:String(e);return t.endsWith(".")?t.slice(0,-1):t}(e)}.`)}},r.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}},{superstruct:601}],76:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.base64=void 0;const n=e("superstruct"),i=e("./assert");r.base64=(e,t={})=>{const r=t.paddingRequired??!1,s=t.characterSet??"base64";let o,a;return"base64"===s?o=String.raw`[A-Za-z0-9+\/]`:((0,i.assert)("base64url"===s),o=String.raw`[-_A-Za-z0-9]`),a=r?new RegExp(`^(?:${o}{4})*(?:${o}{3}=|${o}{2}==)?$`,"u"):new RegExp(`^(?:${o}{4})*(?:${o}{2,3}|${o}{3}=|${o}{2}==)?$`,"u"),(0,n.pattern)(e,a)}},{"./assert":75,superstruct:601}],77:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createDataView=r.concatBytes=r.valueToBytes=r.stringToBytes=r.numberToBytes=r.signedBigIntToBytes=r.bigIntToBytes=r.hexToBytes=r.bytesToString=r.bytesToNumber=r.bytesToSignedBigInt=r.bytesToBigInt=r.bytesToHex=r.assertIsBytes=r.isBytes=void 0;const n=e("./assert"),i=e("./hex"),s=48,o=58,a=87;const u=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function c(e){return e instanceof Uint8Array}function l(e){(0,n.assert)(c(e),"Value must be a Uint8Array.")}function f(e){if(l(e),0===e.length)return"0x";const t=u(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,i.add0x)(r.join(""))}function d(e){l(e);const t=f(e);return BigInt(t)}function h(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,i.assertIsHexString)(e);const t=(0,i.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),i=r.charCodeAt(2*e+1),u=t-(t<o?s:a),c=i-(i<o?s:a);n[e]=16*u+c}return n}function p(e){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return h(e.toString(16))}function m(e){(0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return h(e.toString(16))}function g(e){return(0,n.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function b(e){if("bigint"==typeof e)return p(e);if("number"==typeof e)return m(e);if("string"==typeof e)return e.startsWith("0x")?h(e):g(e);if(c(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}r.isBytes=c,r.assertIsBytes=l,r.bytesToHex=f,r.bytesToBigInt=d,r.bytesToSignedBigInt=function(e){l(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)},r.bytesToNumber=function(e){l(e);const t=d(e);return(0,n.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},r.bytesToString=function(e){return l(e),(new TextDecoder).decode(e)},r.hexToBytes=h,r.bigIntToBytes=p,r.signedBigIntToBytes=function(e,t){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)("number"==typeof t,"Byte length must be a number."),(0,n.assert)(t>0,"Byte length must be greater than 0."),(0,n.assert)(function(e,t){(0,n.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const i=new Uint8Array(t);for(let e=0;e<i.length;e++)i[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return i.reverse()},r.numberToBytes=m,r.stringToBytes=g,r.valueToBytes=b,r.concatBytes=function(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const i=b(e[n]);t[n]=i,r+=i.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n},r.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)},{"./assert":75,"./hex":82,buffer:365}],78:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChecksumStruct=void 0;const n=e("superstruct"),i=e("./base64");r.ChecksumStruct=(0,n.size)((0,i.base64)((0,n.string)(),{paddingRequired:!0}),44,44)},{"./base64":76,superstruct:601}],79:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createHex=r.createBytes=r.createBigInt=r.createNumber=void 0;const n=e("superstruct"),i=e("./assert"),s=e("./bytes"),o=e("./hex"),a=(0,n.union)([(0,n.number)(),(0,n.bigint)(),(0,n.string)(),o.StrictHexStruct]),u=(0,n.coerce)((0,n.number)(),a,Number),c=(0,n.coerce)((0,n.bigint)(),a,BigInt),l=((0,n.union)([o.StrictHexStruct,(0,n.instance)(Uint8Array)]),(0,n.coerce)((0,n.instance)(Uint8Array),(0,n.union)([o.StrictHexStruct]),s.hexToBytes)),f=(0,n.coerce)(o.StrictHexStruct,(0,n.instance)(Uint8Array),s.bytesToHex);r.createNumber=function(e){try{const t=(0,n.create)(e,u);return(0,i.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof n.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},r.createBigInt=function(e){try{return(0,n.create)(e,c)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}},r.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,n.create)(e,l)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}},r.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,n.create)(e,f)}catch(e){if(e instanceof n.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}},{"./assert":75,"./bytes":77,"./hex":82,superstruct:601}],80:[function(e,t,r){"use strict";var n,i,s=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},o=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.FrozenSet=r.FrozenMap=void 0;class a{constructor(e){n.set(this,void 0),s(this,n,new Map(e),"f"),Object.freeze(this)}get size(){return o(this,n,"f").size}[(n=new WeakMap,Symbol.iterator)](){return o(this,n,"f")[Symbol.iterator]()}entries(){return o(this,n,"f").entries()}forEach(e,t){return o(this,n,"f").forEach(((r,n,i)=>e.call(t,r,n,this)))}get(e){return o(this,n,"f").get(e)}has(e){return o(this,n,"f").has(e)}keys(){return o(this,n,"f").keys()}values(){return o(this,n,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}}r.FrozenMap=a;class u{constructor(e){i.set(this,void 0),s(this,i,new Set(e),"f"),Object.freeze(this)}get size(){return o(this,i,"f").size}[(i=new WeakMap,Symbol.iterator)](){return o(this,i,"f")[Symbol.iterator]()}entries(){return o(this,i,"f").entries()}forEach(e,t){return o(this,i,"f").forEach(((r,n,i)=>e.call(t,r,n,this)))}has(e){return o(this,i,"f").has(e)}keys(){return o(this,i,"f").keys()}values(){return o(this,i,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}}r.FrozenSet=u,Object.freeze(a),Object.freeze(a.prototype),Object.freeze(u),Object.freeze(u.prototype)},{}],81:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],82:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.remove0x=r.add0x=r.isValidChecksumAddress=r.getChecksumAddress=r.isValidHexAddress=r.assertIsStrictHexString=r.assertIsHexString=r.isStrictHexString=r.isHexString=r.HexChecksumAddressStruct=r.HexAddressStruct=r.StrictHexStruct=r.HexStruct=void 0;const n=e("@noble/hashes/sha3"),i=e("superstruct"),s=e("./assert"),o=e("./bytes");function a(e){return(0,i.is)(e,r.HexStruct)}function u(e){return(0,i.is)(e,r.StrictHexStruct)}function c(e){(0,s.assert)((0,i.is)(e,r.HexChecksumAddressStruct),"Invalid hex address.");const t=f(e.toLowerCase()),a=f((0,o.bytesToHex)((0,n.keccak_256)(t)));return`0x${t.split("").map(((e,t)=>{const r=a[t];return(0,s.assert)((0,i.is)(r,(0,i.string)()),"Hash shorter than address."),parseInt(r,16)>7?e.toUpperCase():e})).join("")}`}function l(e){return!!(0,i.is)(e,r.HexChecksumAddressStruct)&&c(e)===e}function f(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}r.HexStruct=(0,i.pattern)((0,i.string)(),/^(?:0x)?[0-9a-f]+$/iu),r.StrictHexStruct=(0,i.pattern)((0,i.string)(),/^0x[0-9a-f]+$/iu),r.HexAddressStruct=(0,i.pattern)((0,i.string)(),/^0x[0-9a-f]{40}$/u),r.HexChecksumAddressStruct=(0,i.pattern)((0,i.string)(),/^0x[0-9a-fA-F]{40}$/u),r.isHexString=a,r.isStrictHexString=u,r.assertIsHexString=function(e){(0,s.assert)(a(e),"Value must be a hexadecimal string.")},r.assertIsStrictHexString=function(e){(0,s.assert)(u(e),'Value must be a hexadecimal string, starting with "0x".')},r.isValidHexAddress=function(e){return(0,i.is)(e,r.HexAddressStruct)||l(e)},r.getChecksumAddress=c,r.isValidChecksumAddress=l,r.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},r.remove0x=f},{"./assert":75,"./bytes":77,"@noble/hashes/sha3":321,superstruct:601}],83:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./assert"),r),i(e("./base64"),r),i(e("./bytes"),r),i(e("./checksum"),r),i(e("./coercers"),r),i(e("./collections"),r),i(e("./encryption-types"),r),i(e("./hex"),r),i(e("./json"),r),i(e("./keyring"),r),i(e("./logging"),r),i(e("./misc"),r),i(e("./number"),r),i(e("./opaque"),r),i(e("./time"),r),i(e("./transaction-types"),r),i(e("./versions"),r)},{"./assert":75,"./base64":76,"./bytes":77,"./checksum":78,"./coercers":79,"./collections":80,"./encryption-types":81,"./hex":82,"./json":84,"./keyring":85,"./logging":86,"./misc":87,"./number":88,"./opaque":89,"./time":90,"./transaction-types":91,"./versions":92}],84:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getJsonRpcIdValidator=r.assertIsJsonRpcError=r.isJsonRpcError=r.assertIsJsonRpcFailure=r.isJsonRpcFailure=r.assertIsJsonRpcSuccess=r.isJsonRpcSuccess=r.assertIsJsonRpcResponse=r.isJsonRpcResponse=r.assertIsPendingJsonRpcResponse=r.isPendingJsonRpcResponse=r.JsonRpcResponseStruct=r.JsonRpcFailureStruct=r.JsonRpcSuccessStruct=r.PendingJsonRpcResponseStruct=r.assertIsJsonRpcRequest=r.isJsonRpcRequest=r.assertIsJsonRpcNotification=r.isJsonRpcNotification=r.JsonRpcNotificationStruct=r.JsonRpcRequestStruct=r.JsonRpcParamsStruct=r.JsonRpcErrorStruct=r.JsonRpcIdStruct=r.JsonRpcVersionStruct=r.jsonrpc2=r.getJsonSize=r.getSafeJson=r.isValidJson=r.JsonStruct=r.UnsafeJsonStruct=void 0;const n=e("superstruct"),i=e("./assert");function s(e){return(0,n.create)(e,r.JsonStruct)}r.UnsafeJsonStruct=(0,n.union)([(0,n.literal)(null),(0,n.boolean)(),(0,n.define)("finite number",(e=>(0,n.is)(e,(0,n.number)())&&Number.isFinite(e))),(0,n.string)(),(0,n.array)((0,n.lazy)((()=>r.UnsafeJsonStruct))),(0,n.record)((0,n.string)(),(0,n.lazy)((()=>r.UnsafeJsonStruct)))]),r.JsonStruct=(0,n.coerce)(r.UnsafeJsonStruct,(0,n.any)(),(e=>((0,i.assertStruct)(e,r.UnsafeJsonStruct),JSON.parse(JSON.stringify(e,((e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t})))))),r.isValidJson=function(e){try{return s(e),!0}catch{return!1}},r.getSafeJson=s,r.getJsonSize=function(e){(0,i.assertStruct)(e,r.JsonStruct,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength},r.jsonrpc2="2.0",r.JsonRpcVersionStruct=(0,n.literal)(r.jsonrpc2),r.JsonRpcIdStruct=(0,n.nullable)((0,n.union)([(0,n.number)(),(0,n.string)()])),r.JsonRpcErrorStruct=(0,n.object)({code:(0,n.integer)(),message:(0,n.string)(),data:(0,n.optional)(r.JsonStruct),stack:(0,n.optional)((0,n.string)())}),r.JsonRpcParamsStruct=(0,n.optional)((0,n.union)([(0,n.record)((0,n.string)(),r.JsonStruct),(0,n.array)(r.JsonStruct)])),r.JsonRpcRequestStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,method:(0,n.string)(),params:r.JsonRpcParamsStruct}),r.JsonRpcNotificationStruct=(0,n.omit)(r.JsonRpcRequestStruct,["id"]),r.isJsonRpcNotification=function(e){return(0,n.is)(e,r.JsonRpcNotificationStruct)},r.assertIsJsonRpcNotification=function(e,t){(0,i.assertStruct)(e,r.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",t)},r.isJsonRpcRequest=function(e){return(0,n.is)(e,r.JsonRpcRequestStruct)},r.assertIsJsonRpcRequest=function(e,t){(0,i.assertStruct)(e,r.JsonRpcRequestStruct,"Invalid JSON-RPC request",t)},r.PendingJsonRpcResponseStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:(0,n.optional)((0,n.unknown)()),error:(0,n.optional)(r.JsonRpcErrorStruct)}),r.JsonRpcSuccessStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,result:r.JsonStruct}),r.JsonRpcFailureStruct=(0,n.object)({id:r.JsonRpcIdStruct,jsonrpc:r.JsonRpcVersionStruct,error:r.JsonRpcErrorStruct}),r.JsonRpcResponseStruct=(0,n.union)([r.JsonRpcSuccessStruct,r.JsonRpcFailureStruct]),r.isPendingJsonRpcResponse=function(e){return(0,n.is)(e,r.PendingJsonRpcResponseStruct)},r.assertIsPendingJsonRpcResponse=function(e,t){(0,i.assertStruct)(e,r.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",t)},r.isJsonRpcResponse=function(e){return(0,n.is)(e,r.JsonRpcResponseStruct)},r.assertIsJsonRpcResponse=function(e,t){(0,i.assertStruct)(e,r.JsonRpcResponseStruct,"Invalid JSON-RPC response",t)},r.isJsonRpcSuccess=function(e){return(0,n.is)(e,r.JsonRpcSuccessStruct)},r.assertIsJsonRpcSuccess=function(e,t){(0,i.assertStruct)(e,r.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",t)},r.isJsonRpcFailure=function(e){return(0,n.is)(e,r.JsonRpcFailureStruct)},r.assertIsJsonRpcFailure=function(e,t){(0,i.assertStruct)(e,r.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",t)},r.isJsonRpcError=function(e){return(0,n.is)(e,r.JsonRpcErrorStruct)},r.assertIsJsonRpcError=function(e,t){(0,i.assertStruct)(e,r.JsonRpcErrorStruct,"Invalid JSON-RPC error",t)},r.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:r,permitNull:n}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(r||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||n&&null===e)}},{"./assert":75,superstruct:601}],85:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],86:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.createProjectLogger=void 0;const i=(0,n(e("debug")).default)("metamask");r.createProjectLogger=function(e){return i.extend(e)},r.createModuleLogger=function(e,t){return e.extend(t)}},{debug:382}],87:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calculateNumberSize=r.calculateStringSize=r.isASCII=r.isPlainObject=r.ESCAPE_CHARACTERS_REGEXP=r.JsonSize=r.hasProperty=r.isObject=r.isNullOrUndefined=r.isNonEmptyArray=void 0,r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isNullOrUndefined=function(e){return null==e},r.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};function n(e){return e.charCodeAt(0)<=127}r.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(r.JsonSize||(r.JsonSize={})),r.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,r.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},r.isASCII=n,r.calculateStringSize=function(e){return e.split("").reduce(((e,t)=>n(t)?e+1:e+2),0)+(e.match(r.ESCAPE_CHARACTERS_REGEXP)??[]).length},r.calculateNumberSize=function(e){return e.toString().length}},{}],88:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hexToBigInt=r.hexToNumber=r.bigIntToHex=r.numberToHex=void 0;const n=e("./assert"),i=e("./hex");r.numberToHex=e=>((0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,i.add0x)(e.toString(16)));r.bigIntToHex=e=>((0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=0,"Value must be a non-negative bigint."),(0,i.add0x)(e.toString(16)));r.hexToNumber=e=>{(0,i.assertIsHexString)(e);const t=parseInt(e,16);return(0,n.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};r.hexToBigInt=e=>((0,i.assertIsHexString)(e),BigInt((0,i.add0x)(e)))},{"./assert":75,"./hex":82}],89:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],90:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.timeSince=r.inMilliseconds=r.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(r.Duration||(r.Duration={}));const n=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};r.inMilliseconds=function(e,t){return n(e,"count"),e*t},r.timeSince=function(e){return n(e,"timestamp"),Date.now()-e}},{}],91:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},{}],92:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.satisfiesVersionRange=r.gtRange=r.gtVersion=r.assertIsSemVerRange=r.assertIsSemVerVersion=r.isValidSemVerRange=r.isValidSemVerVersion=r.VersionRangeStruct=r.VersionStruct=void 0;const n=e("semver"),i=e("superstruct"),s=e("./assert");r.VersionStruct=(0,i.refine)((0,i.string)(),"Version",(e=>null!==(0,n.valid)(e)||`Expected SemVer version, got "${e}"`)),r.VersionRangeStruct=(0,i.refine)((0,i.string)(),"Version range",(e=>null!==(0,n.validRange)(e)||`Expected SemVer range, got "${e}"`)),r.isValidSemVerVersion=function(e){return(0,i.is)(e,r.VersionStruct)},r.isValidSemVerRange=function(e){return(0,i.is)(e,r.VersionRangeStruct)},r.assertIsSemVerVersion=function(e){(0,s.assertStruct)(e,r.VersionStruct)},r.assertIsSemVerRange=function(e){(0,s.assertStruct)(e,r.VersionRangeStruct)},r.gtVersion=function(e,t){return(0,n.gt)(e,t)},r.gtRange=function(e,t){return(0,n.gtr)(e,t)},r.satisfiesVersionRange=function(e,t){return(0,n.satisfies)(e,t,{includePrerelease:!0})}},{"./assert":75,semver:557,superstruct:601}],93:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.decorateWithCaveats=r.isRestrictedMethodCaveatSpecification=void 0;const i=e("@metamask/utils"),s=e("./errors"),o=e("./Permission");function a(e){return(0,i.hasProperty)(e,"decorator")}r.isRestrictedMethodCaveatSpecification=a,r.decorateWithCaveats=function(e,t,r){const{caveats:i}=t;if(!i)return e;let u=t=>n(this,void 0,void 0,(function*(){return e(t)}));for(const e of i){const t=r[e.type];if(!t)throw new s.UnrecognizedCaveatTypeError(e.type);if(!a(t))throw new s.CaveatSpecificationMismatchError(t,o.PermissionType.RestrictedMethod);u=t.decorator(u,e)}return u}},{"./Permission":94,"./errors":97,"@metamask/utils":113}],94:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hasSpecificationType=r.PermissionType=r.findCaveat=r.constructPermission=void 0;const n=e("nanoid");r.constructPermission=function(e){const{caveats:t=null,invoker:r,target:i}=e;return{id:(0,n.nanoid)(),parentCapability:i,invoker:r,caveats:t,date:(new Date).getTime()}},r.findCaveat=function(e,t){var r;return null===(r=e.caveats)||void 0===r?void 0:r.find((e=>e.type===t))},function(e){e.RestrictedMethod="RestrictedMethod",e.Endowment="Endowment"}(r.PermissionType||(r.PermissionType={})),r.hasSpecificationType=function(e,t){return e.permissionType===t}},{nanoid:123}],95:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionController=r.CaveatMutatorOperation=void 0;const o=e("@metamask/base-controller"),a=e("@metamask/controller-utils"),u=e("@metamask/rpc-errors"),c=e("@metamask/utils"),l=s(e("deep-freeze-strict")),f=e("immer"),d=e("nanoid"),h=e("./Caveat"),p=e("./errors"),m=e("./Permission"),g=e("./permission-middleware"),b=e("./utils"),y="PermissionController";var v;!function(e){e[e.noop=0]="noop",e[e.updateValue=1]="updateValue",e[e.deleteCaveat=2]="deleteCaveat",e[e.revokePermission=3]="revokePermission"}(v=r.CaveatMutatorOperation||(r.CaveatMutatorOperation={}));class w extends o.BaseControllerV2{constructor(e){const{caveatSpecifications:t,permissionSpecifications:r,unrestrictedMethods:n,messenger:i,state:s={}}=e;super({name:y,metadata:{subjects:{anonymous:!0,persist:!0}},messenger:i,state:Object.assign(Object.assign({},{subjects:{}}),s)}),this._unrestrictedMethods=new Set(n),this._caveatSpecifications=(0,l.default)(Object.assign({},t)),this.validatePermissionSpecifications(r,this._caveatSpecifications),this._permissionSpecifications=(0,l.default)(Object.assign({},r)),this.registerMessageHandlers(),this.createPermissionMiddleware=(0,g.getPermissionMiddlewareFactory)({executeRestrictedMethod:this._executeRestrictedMethod.bind(this),getRestrictedMethod:this.getRestrictedMethod.bind(this),isUnrestrictedMethod:this.unrestrictedMethods.has.bind(this.unrestrictedMethods)})}get unrestrictedMethods(){return this._unrestrictedMethods}getPermissionSpecification(e){return this._permissionSpecifications[e]}getCaveatSpecification(e){return this._caveatSpecifications[e]}validatePermissionSpecifications(e,t){Object.entries(e).forEach((([e,{permissionType:r,targetName:n,allowedCaveats:i}])=>{if(!r||!(0,c.hasProperty)(m.PermissionType,r))throw new Error(`Invalid permission type: "${r}"`);if(!e)throw new Error(`Invalid permission target name: "${e}"`);if(e!==n)throw new Error(`Invalid permission specification: target name "${e}" must match specification.targetName value "${n}".`);i&&i.forEach((e=>{if(!(0,c.hasProperty)(t,e))throw new p.UnrecognizedCaveatTypeError(e);const n=t[e],i=(0,h.isRestrictedMethodCaveatSpecification)(n);if(r===m.PermissionType.RestrictedMethod&&!i||r===m.PermissionType.Endowment&&i)throw new p.CaveatSpecificationMismatchError(n,r)}))}))}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${y}:clearPermissions`,(()=>this.clearState())),this.messagingSystem.registerActionHandler(`${y}:getEndowments`,((e,t,r)=>this.getEndowments(e,t,r))),this.messagingSystem.registerActionHandler(`${y}:getSubjectNames`,(()=>this.getSubjectNames())),this.messagingSystem.registerActionHandler(`${y}:getPermissions`,(e=>this.getPermissions(e))),this.messagingSystem.registerActionHandler(`${y}:hasPermission`,((e,t)=>this.hasPermission(e,t))),this.messagingSystem.registerActionHandler(`${y}:hasPermissions`,(e=>this.hasPermissions(e))),this.messagingSystem.registerActionHandler(`${y}:grantPermissions`,this.grantPermissions.bind(this)),this.messagingSystem.registerActionHandler(`${y}:requestPermissions`,((e,t)=>this.requestPermissions(e,t))),this.messagingSystem.registerActionHandler(`${y}:revokeAllPermissions`,(e=>this.revokeAllPermissions(e))),this.messagingSystem.registerActionHandler(`${y}:revokePermissionForAllSubjects`,(e=>this.revokePermissionForAllSubjects(e))),this.messagingSystem.registerActionHandler(`${y}:revokePermissions`,this.revokePermissions.bind(this)),this.messagingSystem.registerActionHandler(`${y}:updateCaveat`,((e,t,r,n)=>{this.updateCaveat(e,t,r,n)}))}clearState(){this.update((e=>Object.assign({},{subjects:{}})))}getTypedPermissionSpecification(e,t,r){const n=e===m.PermissionType.RestrictedMethod?(0,p.methodNotFound)(t,r?{origin:r}:void 0):new p.EndowmentPermissionDoesNotExistError(t,r);if(!this.targetExists(t))throw n;const i=this.getPermissionSpecification(t);if(!(0,m.hasSpecificationType)(i,e))throw n;return i}getRestrictedMethod(e,t){return this.getTypedPermissionSpecification(m.PermissionType.RestrictedMethod,e,t).methodImplementation}getSubjectNames(){return Object.keys(this.state.subjects)}getPermission(e,t){var r;return null===(r=this.state.subjects[e])||void 0===r?void 0:r.permissions[t]}getPermissions(e){var t;return null===(t=this.state.subjects[e])||void 0===t?void 0:t.permissions}hasPermission(e,t){return Boolean(this.getPermission(e,t))}hasPermissions(e){return Boolean(this.state.subjects[e])}revokeAllPermissions(e){this.update((t=>{if(!t.subjects[e])throw new p.UnrecognizedSubjectError(e);delete t.subjects[e]}))}revokePermission(e,t){this.revokePermissions({[e]:[t]})}revokePermissions(e){this.update((t=>{Object.keys(e).forEach((r=>{if(!(0,c.hasProperty)(t.subjects,r))throw new p.UnrecognizedSubjectError(r);e[r].forEach((e=>{const{permissions:n}=t.subjects[r];if(!(0,c.hasProperty)(n,e))throw new p.PermissionDoesNotExistError(r,e);this.deletePermission(t.subjects,r,e)}))}))}))}revokePermissionForAllSubjects(e){0!==this.getSubjectNames().length&&this.update((t=>{Object.entries(t.subjects).forEach((([r,n])=>{const{permissions:i}=n;(0,c.hasProperty)(i,e)&&this.deletePermission(t.subjects,r,e)}))}))}deletePermission(e,t,r){const{permissions:n}=e[t];Object.keys(n).length>1?delete n[r]:delete e[t]}hasCaveat(e,t,r){return Boolean(this.getCaveat(e,t,r))}getCaveat(e,t,r){const n=this.getPermission(e,t);if(!n)throw new p.PermissionDoesNotExistError(e,t);return(0,m.findCaveat)(n,r)}addCaveat(e,t,r,n){if(this.hasCaveat(e,t,r))throw new p.CaveatAlreadyExistsError(e,t,r);this.setCaveat(e,t,r,n)}updateCaveat(e,t,r,n){if(!this.hasCaveat(e,t,r))throw new p.CaveatDoesNotExistError(e,t,r);this.setCaveat(e,t,r,n)}setCaveat(e,t,r,n){this.update((i=>{const s=i.subjects[e];if(!s)throw new p.UnrecognizedSubjectError(e);const o=s.permissions[t];if(!o)throw new p.PermissionDoesNotExistError(e,t);const a={type:r,value:n};if(this.validateCaveat(a,e,t),o.caveats){const e=o.caveats.findIndex((e=>e.type===a.type));-1===e?o.caveats.push(a):o.caveats.splice(e,1,a)}else o.caveats=[a];this.validateModifiedPermission(o,e)}))}updatePermissionsByCaveat(e,t){0!==Object.keys(this.state.subjects).length&&this.update((r=>{Object.values(r.subjects).forEach((n=>{Object.values(n.permissions).forEach((i=>{const{caveats:s}=i,o=null==s?void 0:s.find((({type:t})=>t===e));if(!o)return;const a=t(o.value);switch(a.operation){case v.noop:break;case v.updateValue:o.value=a.value,this.validateCaveat(o,n.origin,i.parentCapability);break;case v.deleteCaveat:this.deleteCaveat(i,e,n.origin);break;case v.revokePermission:this.deletePermission(r.subjects,n.origin,i.parentCapability);break;default:throw new Error(`Unrecognized mutation result: "${a.operation}"`)}}))}))}))}removeCaveat(e,t,r){this.update((n=>{var i;const s=null===(i=n.subjects[e])||void 0===i?void 0:i.permissions[t];if(!s)throw new p.PermissionDoesNotExistError(e,t);if(!s.caveats)throw new p.CaveatDoesNotExistError(e,t,r);this.deleteCaveat(s,r,e)}))}deleteCaveat(e,t,r){if(!e.caveats)throw new p.CaveatDoesNotExistError(r,e.parentCapability,t);const n=e.caveats.findIndex((e=>e.type===t));if(-1===n)throw new p.CaveatDoesNotExistError(r,e.parentCapability,t);1===e.caveats.length?e.caveats=null:e.caveats.splice(n,1),this.validateModifiedPermission(e,r)}validateModifiedPermission(e,t){if(!this.targetExists(e.parentCapability))throw new Error(`Fatal: Existing permission target "${e.parentCapability}" has no specification.`);this.validatePermission(this.getPermissionSpecification(e.parentCapability),e,t)}targetExists(e){return(0,c.hasProperty)(this._permissionSpecifications,e)}grantPermissions({approvedPermissions:e,requestData:t,preserveExistingPermissions:r=!0,subject:n}){const{origin:i}=n;if(!i||"string"!=typeof i)throw new p.InvalidSubjectIdentifierError(i);const s=r?Object.assign({},this.getPermissions(i)):{};for(const[r,n]of Object.entries(e)){if(!this.targetExists(r))throw(0,p.methodNotFound)(r);if(void 0!==n.parentCapability&&r!==n.parentCapability)throw new p.InvalidApprovedPermissionError(i,r,n);const e=r,o=this.getPermissionSpecification(e),a={caveats:this.constructCaveats(i,e,n.caveats),invoker:i,target:e};let u;o.factory?(u=o.factory(a,t),this.validatePermission(o,u,i)):(u=(0,m.constructPermission)(a),this.validatePermission(o,u,i,{invokePermissionValidator:!0,performCaveatValidation:!1})),s[e]=u}return this.setValidatedPermissions(i,s),s}validatePermission(e,t,r,{invokePermissionValidator:n,performCaveatValidation:i}={invokePermissionValidator:!0,performCaveatValidation:!0}){var s;const{allowedCaveats:o,validator:a,targetName:u}=e;if((null===(s=e.subjectTypes)||void 0===s?void 0:s.length)&&e.subjectTypes.length>0){const t=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",r);if(!t||null===t.subjectType||!e.subjectTypes.includes(t.subjectType))throw e.permissionType===m.PermissionType.RestrictedMethod?(0,p.methodNotFound)(u,{origin:r}):new p.EndowmentPermissionDoesNotExistError(u,r)}if((0,c.hasProperty)(t,"caveats")){const{caveats:e}=t;if(null!==e&&!(Array.isArray(e)&&e.length>0))throw new p.InvalidCaveatsPropertyError(r,u,e);const n=new Set;null==e||e.forEach((e=>{if(i&&this.validateCaveat(e,r,u),!(null==o?void 0:o.includes(e.type)))throw new p.ForbiddenCaveatError(e.type,r,u);if(n.has(e.type))throw new p.DuplicateCaveatError(e.type,r,u);n.add(e.type)}))}n&&a&&a(t,r,u)}setValidatedPermissions(e,t){this.update((r=>{r.subjects[e]||(r.subjects[e]={origin:e,permissions:{}}),r.subjects[e].permissions=(0,f.castDraft)(t)}))}constructCaveats(e,t,r){const n=null==r?void 0:r.map((r=>{this.validateCaveat(r,e,t);const{type:n,value:i}=r;return{type:n,value:i}}));return n&&(0,a.isNonEmptyArray)(n)?n:void 0}validateCaveat(e,t,r){var n;if(!(0,a.isPlainObject)(e))throw new p.InvalidCaveatError(e,t,r);if(2!==Object.keys(e).length)throw new p.InvalidCaveatFieldsError(e,t,r);if("string"!=typeof e.type)throw new p.InvalidCaveatTypeError(e,t,r);const i=this.getCaveatSpecification(e.type);if(!i)throw new p.UnrecognizedCaveatTypeError(e.type,t,r);if(!(0,c.hasProperty)(e,"value")||void 0===e.value)throw new p.CaveatMissingValueError(e,t,r);if(!(0,a.isValidJson)(e.value))throw new p.CaveatInvalidJsonError(e,t,r);null===(n=i.validator)||void 0===n||n.call(i,e,t,r)}requestPermissions(e,t,r={}){return n(this,void 0,void 0,(function*(){const{origin:n}=e,{id:s=(0,d.nanoid)(),preserveExistingPermissions:o=!0}=r;this.validateRequestedPermissions(n,t);const a={id:s,origin:n},u={metadata:a,permissions:t},c=yield this.requestUserApproval(u),{permissions:l}=c,f=i(c,["permissions"]),h=this.getSideEffects(l);if(Object.values(h.permittedHandlers).length>0){const t=yield this.executeSideEffects(h,c),r=Object.keys(h.permittedHandlers).reduce(((e,r,n)=>Object.assign({[r]:t[n]},e)),{});return[this.grantPermissions({subject:e,approvedPermissions:l,preserveExistingPermissions:o,requestData:f}),Object.assign({data:r},a)]}return[this.grantPermissions({subject:e,approvedPermissions:l,preserveExistingPermissions:o,requestData:f}),a]}))}validateRequestedPermissions(e,t){if(!(0,a.isPlainObject)(t))throw(0,p.invalidParams)({message:`Requested permissions for origin "${e}" is not a plain object.`,data:{origin:e,requestedPermissions:t}});if(0===Object.keys(t).length)throw(0,p.invalidParams)({message:`Permissions request for origin "${e}" contains no permissions.`,data:{requestedPermissions:t}});for(const r of Object.keys(t)){const n=t[r];if(!this.targetExists(r))throw(0,p.methodNotFound)(r,{origin:e,requestedPermissions:t});if(!(0,a.isPlainObject)(n)||void 0!==n.parentCapability&&r!==n.parentCapability)throw(0,p.invalidParams)({message:`Permissions request for origin "${e}" contains invalid requested permission(s).`,data:{origin:e,requestedPermissions:t}});this.validatePermission(this.getPermissionSpecification(r),n,e,{invokePermissionValidator:!1,performCaveatValidation:!0})}}requestUserApproval(e){return n(this,void 0,void 0,(function*(){const{origin:t,id:r}=e.metadata,n=yield this.messagingSystem.call("ApprovalController:addRequest",{id:r,origin:t,requestData:e,type:b.MethodNames.requestPermissions},!0);return this.validateApprovedPermissions(n,{id:r,origin:t}),n}))}getSideEffects(e){return Object.keys(e).reduce(((e,t)=>{if(this.targetExists(t)){const r=this.getPermissionSpecification(t);r.sideEffect&&(e.permittedHandlers[t]=r.sideEffect.onPermitted,r.sideEffect.onFailure&&(e.failureHandlers[t]=r.sideEffect.onFailure))}return e}),{permittedHandlers:{},failureHandlers:{}})}executeSideEffects(e,t){return n(this,void 0,void 0,(function*(){const{permittedHandlers:r,failureHandlers:n}=e,i={requestData:t,messagingSystem:this.messagingSystem},s=yield Promise.allSettled(Object.values(r).map((e=>e(i)))),o=s.filter((e=>"rejected"===e.status));if(o.length>0){const e=Object.values(n);if(e.length>0)try{yield Promise.all(e.map((e=>e(i))))}catch(e){throw(0,p.internalError)("Unexpected error in side-effects",{error:e})}const t=o.map((e=>e.reason));throw t.forEach((e=>{console.error(e)})),t.length>1?(0,p.internalError)("Multiple errors occurred during side-effects execution",{errors:t}):t[0]}return s.map((({value:e})=>e))}))}validateApprovedPermissions(e,t){const{id:r,origin:n}=t;if(!(0,a.isPlainObject)(e)||!(0,a.isPlainObject)(e.metadata))throw(0,p.internalError)(`Approved permissions request for subject "${n}" is invalid.`,{data:{approvedRequest:e}});const{metadata:{id:i,origin:s},permissions:o}=e;if(i!==r)throw(0,p.internalError)(`Approved permissions request for subject "${n}" mutated its id.`,{originalId:r,mutatedId:i});if(s!==n)throw(0,p.internalError)(`Approved permissions request for subject "${n}" mutated its origin.`,{originalOrigin:n,mutatedOrigin:s});try{this.validateRequestedPermissions(n,o)}catch(e){if(e instanceof u.JsonRpcError)throw(0,p.internalError)(`Invalid approved permissions request: ${e.message}`,e.data);throw(0,p.internalError)("Unrecognized error type",{error:e})}}acceptPermissionsRequest(e){return n(this,void 0,void 0,(function*(){const{id:t}=e.metadata;if(!this.hasApprovalRequest({id:t}))throw new p.PermissionsRequestNotFoundError(t);if(0!==Object.keys(e.permissions).length)try{this.messagingSystem.call("ApprovalController:acceptRequest",t,e)}catch(e){throw this._rejectPermissionsRequest(t,e),e}else this._rejectPermissionsRequest(t,(0,p.invalidParams)({message:"Must request at least one permission."}))}))}rejectPermissionsRequest(e){return n(this,void 0,void 0,(function*(){if(!this.hasApprovalRequest({id:e}))throw new p.PermissionsRequestNotFoundError(e);this._rejectPermissionsRequest(e,(0,p.userRejectedRequest)())}))}hasApprovalRequest(e){return this.messagingSystem.call("ApprovalController:hasRequest",e)}_rejectPermissionsRequest(e,t){return this.messagingSystem.call("ApprovalController:rejectRequest",e,t)}getEndowments(e,t,r){return n(this,void 0,void 0,(function*(){if(!this.hasPermission(e,t))throw(0,p.unauthorized)({data:{origin:e,targetName:t}});return this.getTypedPermissionSpecification(m.PermissionType.Endowment,t,e).endowmentGetter({origin:e,requestData:r})}))}executeRestrictedMethod(e,t,r){return n(this,void 0,void 0,(function*(){const n=this.getRestrictedMethod(t,e),i=yield this._executeRestrictedMethod(n,{origin:e},t,r);if(void 0===i)throw new Error(`Internal request for method "${t}" as origin "${e}" returned no result.`);return i}))}_executeRestrictedMethod(e,t,r,n=[]){const{origin:i}=t,s=this.getPermission(i,r);if(!s)throw(0,p.unauthorized)({data:{origin:i,method:r}});return(0,h.decorateWithCaveats)(e,s,this._caveatSpecifications)({method:r,params:n,context:{origin:i}})}}r.PermissionController=w},{"./Caveat":93,"./Permission":94,"./errors":97,"./permission-middleware":99,"./utils":103,"@metamask/base-controller":5,"@metamask/controller-utils":7,"@metamask/rpc-errors":147,"@metamask/utils":113,"deep-freeze-strict":384,immer:471,nanoid:123}],96:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SubjectMetadataController=r.SubjectType=void 0;const n=e("@metamask/base-controller");!function(e){e.Extension="extension",e.Internal="internal",e.Unknown="unknown",e.Website="website",e.Snap="snap"}(r.SubjectType||(r.SubjectType={}));const i={subjectMetadata:{persist:!0,anonymous:!1}},s={subjectMetadata:{}};class o extends n.BaseControllerV2{constructor({messenger:e,subjectCacheLimit:t,state:r={}}){if(!Number.isInteger(t)||t<1)throw new Error(`subjectCacheLimit must be a positive integer. Received: "${t}"`);const n=t=>e.call("PermissionController:hasPermissions",t);super({name:"SubjectMetadataController",metadata:i,messenger:e,state:Object.assign({},o.getTrimmedState(r,n))}),this.subjectHasPermissions=n,this.subjectCacheLimit=t,this.subjectsWithoutPermissionsEncounteredSinceStartup=new Set,this.messagingSystem.registerActionHandler(`${this.name}:getSubjectMetadata`,this.getSubjectMetadata.bind(this))}clearState(){this.subjectsWithoutPermissionsEncounteredSinceStartup.clear(),this.update((e=>Object.assign({},s)))}addSubjectMetadata(e){const{origin:t}=e,r=Object.assign(Object.assign({},e),{extensionId:e.extensionId||null,iconUrl:e.iconUrl||null,name:e.name||null,subjectType:e.subjectType||null});let n=null;if(this.subjectsWithoutPermissionsEncounteredSinceStartup.size>=this.subjectCacheLimit){const e=this.subjectsWithoutPermissionsEncounteredSinceStartup.values().next().value;this.subjectsWithoutPermissionsEncounteredSinceStartup.delete(e),this.subjectHasPermissions(e)||(n=e)}this.subjectsWithoutPermissionsEncounteredSinceStartup.add(t),this.update((e=>{e.subjectMetadata[t]=r,"string"==typeof n&&delete e.subjectMetadata[n]}))}getSubjectMetadata(e){return this.state.subjectMetadata[e]}trimMetadataState(){this.update((e=>o.getTrimmedState(e,this.subjectHasPermissions)))}static getTrimmedState(e,t){const{subjectMetadata:r={}}=e;return{subjectMetadata:Object.keys(r).reduce(((e,n)=>(t(n)&&(e[n]=r[n]),e)),{})}}}r.SubjectMetadataController=o},{"@metamask/base-controller":5}],97:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionsRequestNotFoundError=r.CaveatSpecificationMismatchError=r.DuplicateCaveatError=r.ForbiddenCaveatError=r.InvalidCaveatFieldsError=r.CaveatInvalidJsonError=r.CaveatMissingValueError=r.InvalidCaveatTypeError=r.InvalidCaveatError=r.CaveatAlreadyExistsError=r.CaveatDoesNotExistError=r.InvalidCaveatsPropertyError=r.UnrecognizedCaveatTypeError=r.EndowmentPermissionDoesNotExistError=r.PermissionDoesNotExistError=r.InvalidApprovedPermissionError=r.UnrecognizedSubjectError=r.InvalidSubjectIdentifierError=r.internalError=r.userRejectedRequest=r.invalidParams=r.methodNotFound=r.unauthorized=void 0;const n=e("@metamask/rpc-errors");r.unauthorized=function(e){return n.providerErrors.unauthorized({message:"Unauthorized to perform action. Try requesting the required permission(s) first. For more information, see: https://docs.metamask.io/guide/rpc-api.html#permissions",data:e.data})},r.methodNotFound=function(e,t){const r={message:`The method "${e}" does not exist / is not available.`};return void 0!==t&&(r.data=t),n.rpcErrors.methodNotFound(r)},r.invalidParams=function(e){return n.rpcErrors.invalidParams({data:e.data,message:e.message})},r.userRejectedRequest=function(e){return n.providerErrors.userRejectedRequest({data:e})},r.internalError=function(e,t){return n.rpcErrors.internal({message:e,data:t})};class i extends Error{constructor(e){super(`Invalid subject identifier: "${"string"==typeof e?e:typeof e}"`)}}r.InvalidSubjectIdentifierError=i;class s extends Error{constructor(e){super(`Unrecognized subject: "${e}" has no permissions.`)}}r.UnrecognizedSubjectError=s;class o extends Error{constructor(e,t,r){super(`Invalid approved permission for origin "${e}" and target "${t}".`),this.data={origin:e,target:t,approvedPermission:r}}}r.InvalidApprovedPermissionError=o;class a extends Error{constructor(e,t){super(`Subject "${e}" has no permission for "${t}".`)}}r.PermissionDoesNotExistError=a;class u extends Error{constructor(e,t){super(`Subject "${t}" has no permission for "${e}".`),t&&(this.data={origin:t})}}r.EndowmentPermissionDoesNotExistError=u;class c extends Error{constructor(e,t,r){super(`Unrecognized caveat type: "${e}"`),this.data={caveatType:e},void 0!==t&&(this.data.origin=t),void 0!==r&&(this.data.target=r)}}r.UnrecognizedCaveatTypeError=c;class l extends Error{constructor(e,t,r){super(`The "caveats" property of permission for "${t}" of subject "${e}" is invalid. It must be a non-empty array if specified.`),this.data={origin:e,target:t,caveatsProperty:r}}}r.InvalidCaveatsPropertyError=l;class f extends Error{constructor(e,t,r){super(`Permission for "${t}" of subject "${e}" has no caveat of type "${r}".`)}}r.CaveatDoesNotExistError=f;class d extends Error{constructor(e,t,r){super(`Permission for "${t}" of subject "${e}" already has a caveat of type "${r}".`)}}r.CaveatAlreadyExistsError=d;class h extends n.JsonRpcError{constructor(e,t,r){super(n.errorCodes.rpc.invalidParams,"Invalid caveat. Caveats must be plain objects.",{receivedCaveat:e}),this.data={origin:t,target:r}}}r.InvalidCaveatError=h;class p extends Error{constructor(e,t,r){super(`Caveat types must be strings. Received: "${typeof e.type}"`),this.data={caveat:e,origin:t,target:r}}}r.InvalidCaveatTypeError=p;class m extends Error{constructor(e,t,r){super('Caveat is missing "value" field.'),this.data={caveat:e,origin:t,target:r}}}r.CaveatMissingValueError=m;class g extends Error{constructor(e,t,r){super('Caveat "value" is invalid JSON.'),this.data={caveat:e,origin:t,target:r}}}r.CaveatInvalidJsonError=g;class b extends Error{constructor(e,t,r){super(`Caveat has unexpected number of fields: "${Object.keys(e).length}"`),this.data={caveat:e,origin:t,target:r}}}r.InvalidCaveatFieldsError=b;class y extends Error{constructor(e,t,r){super(`Permissions for target "${r}" may not have caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:r}}}r.ForbiddenCaveatError=y;class v extends Error{constructor(e,t,r){super(`Permissions for target "${r}" contains multiple caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:r}}}r.DuplicateCaveatError=v;class w extends Error{constructor(e,t){super(`Caveat specification uses a mismatched type. Expected caveats for ${t}`),this.data={caveatSpec:e,permissionType:t}}}r.CaveatSpecificationMismatchError=w;class _ extends Error{constructor(e){super(`Permissions request with id "${e}" not found.`)}}r.PermissionsRequestNotFoundError=_},{"@metamask/rpc-errors":147}],98:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.permissionRpcMethods=void 0,s(e("./Caveat"),r),s(e("./errors"),r),s(e("./Permission"),r),s(e("./PermissionController"),r),s(e("./utils"),r),r.permissionRpcMethods=o(e("./rpc-methods")),s(e("./SubjectMetadataController"),r)},{"./Caveat":93,"./Permission":94,"./PermissionController":95,"./SubjectMetadataController":96,"./errors":97,"./rpc-methods":101,"./utils":103}],99:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.getPermissionMiddlewareFactory=void 0;const i=e("@metamask/json-rpc-engine"),s=e("./errors");r.getPermissionMiddlewareFactory=function({executeRestrictedMethod:e,getRestrictedMethod:t,isUnrestrictedMethod:r}){return function(o){const{origin:a}=o;if("string"!=typeof a||!a)throw new Error('The subject "origin" must be a non-empty string.');return(0,i.createAsyncMiddleware)(((i,u,c)=>n(this,void 0,void 0,(function*(){const{method:n,params:l}=i;if(r(n))return c();const f=t(n,a),d=yield e(f,o,n,l);void 0!==d?u.result=d:u.error=(0,s.internalError)(`Request for method "${i.method}" returned undefined result.`,{request:i})}))))}}},{"./errors":97,"@metamask/json-rpc-engine":36}],100:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.getPermissionsHandler=void 0;const i=e("../utils");r.getPermissionsHandler={methodNames:[i.MethodNames.getPermissions],implementation:function(e,t,r,i,{getPermissionsForOrigin:s}){return n(this,void 0,void 0,(function*(){return t.result=Object.values(s()||{}),i()}))},hookNames:{getPermissionsForOrigin:!0}}},{"../utils":103}],101:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.handlers=void 0;const n=e("./getPermissions"),i=e("./requestPermissions");r.handlers=[i.requestPermissionsHandler,n.getPermissionsHandler]},{"./getPermissions":100,"./requestPermissions":102}],102:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(r,"__esModule",{value:!0}),r.requestPermissionsHandler=void 0;const i=e("@metamask/controller-utils"),s=e("@metamask/rpc-errors"),o=e("../errors"),a=e("../utils");r.requestPermissionsHandler={methodNames:[a.MethodNames.requestPermissions],implementation:function(e,t,r,a,{requestPermissionsForOrigin:u}){return n(this,void 0,void 0,(function*(){const{id:r,params:n}=e;if("number"!=typeof r&&"string"!=typeof r||"string"==typeof r&&!r)return a(s.rpcErrors.invalidRequest({message:"Invalid request: Must specify a valid id.",data:{request:e}}));if(!Array.isArray(n)||!(0,i.isPlainObject)(n[0]))return a((0,o.invalidParams)({data:{request:e}}));const[c]=n,[l]=yield u(c,String(r));return t.result=Object.values(l),a()}))},hookNames:{requestPermissionsForOrigin:!0}}},{"../errors":97,"../utils":103,"@metamask/controller-utils":7,"@metamask/rpc-errors":147}],103:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MethodNames=void 0,function(e){e.requestPermissions="wallet_requestPermissions",e.getPermissions="wallet_getPermissions"}(r.MethodNames||(r.MethodNames={}))},{}],104:[function(e,t,r){arguments[4][12][0].apply(r,arguments)},{dup:12,superstruct:601}],105:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"./assert":104,dup:13,superstruct:601}],106:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(r,{isBytes:function(){return c},assertIsBytes:function(){return l},bytesToHex:function(){return f},bytesToBigInt:function(){return d},bytesToSignedBigInt:function(){return h},bytesToNumber:function(){return p},bytesToString:function(){return m},hexToBytes:function(){return g},bigIntToBytes:function(){return b},signedBigIntToBytes:function(){return y},numberToBytes:function(){return v},stringToBytes:function(){return w},valueToBytes:function(){return _},concatBytes:function(){return S},createDataView:function(){return E}});const n=e("./assert"),i=e("./hex"),s=48,o=58,a=87;const u=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function c(e){return e instanceof Uint8Array}function l(e){(0,n.assert)(c(e),"Value must be a Uint8Array.")}function f(e){if(l(e),0===e.length)return"0x";const t=u(),r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=t[e[n]];return(0,i.add0x)(r.join(""))}function d(e){l(e);const t=f(e);return BigInt(t)}function h(e){l(e);let t=BigInt(0);for(const r of e)t=(t<<BigInt(8))+BigInt(r);return BigInt.asIntN(8*e.length,t)}function p(e){l(e);const t=d(e);return(0,n.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)}function m(e){return l(e),(new TextDecoder).decode(e)}function g(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,i.assertIsHexString)(e);const t=(0,i.remove0x)(e).toLowerCase(),r=t.length%2==0?t:`0${t}`,n=new Uint8Array(r.length/2);for(let e=0;e<n.length;e++){const t=r.charCodeAt(2*e),i=r.charCodeAt(2*e+1),u=t-(t<o?s:a),c=i-(i<o?s:a);n[e]=16*u+c}return n}function b(e){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return g(e.toString(16))}function y(e,t){(0,n.assert)("bigint"==typeof e,"Value must be a bigint."),(0,n.assert)("number"==typeof t,"Byte length must be a number."),(0,n.assert)(t>0,"Byte length must be greater than 0."),(0,n.assert)(function(e,t){(0,n.assert)(t>0);const r=e>>BigInt(31);return!((~e&r)+(e&~r)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let r=e;const i=new Uint8Array(t);for(let e=0;e<i.length;e++)i[e]=Number(BigInt.asUintN(8,r)),r>>=BigInt(8);return i.reverse()}function v(e){(0,n.assert)("number"==typeof e,"Value must be a number."),(0,n.assert)(e>=0,"Value must be a non-negative number."),(0,n.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return g(e.toString(16))}function w(e){return(0,n.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function _(e){if("bigint"==typeof e)return b(e);if("number"==typeof e)return v(e);if("string"==typeof e)return e.startsWith("0x")?g(e):w(e);if(c(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}function S(e){const t=new Array(e.length);let r=0;for(let n=0;n<e.length;n++){const i=_(e[n]);t[n]=i,r+=i.length}const n=new Uint8Array(r);for(let e=0,r=0;e<t.length;e++)n.set(t[e],r),r+=t[e].length;return n}function E(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)},{"./assert":104,"./hex":112,buffer:365}],107:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{dup:15,superstruct:601}],108:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{"./base64":105,dup:16,superstruct:601}],109:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./assert":104,"./bytes":106,"./hex":112,dup:17,superstruct:601}],110:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18}],111:[function(e,t,r){arguments[4][19][0].apply(r,arguments)},{dup:19}],112:[function(e,t,r){arguments[4][20][0].apply(r,arguments)},{"./assert":104,"./bytes":106,"@noble/hashes/sha3":321,dup:20,superstruct:601}],113:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{"./assert":104,"./base64":105,"./bytes":106,"./caip-types":107,"./checksum":108,"./coercers":109,"./collections":110,"./encryption-types":111,"./hex":112,"./json":114,"./keyring":115,"./logging":116,"./misc":117,"./number":118,"./opaque":119,"./time":120,"./transaction-types":121,"./versions":122,dup:21}],114:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{"./assert":104,dup:22,superstruct:601}],115:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{dup:23}],116:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{debug:382,dup:24}],117:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{dup:25}],118:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{"./assert":104,"./hex":112,dup:26}],119:[function(e,t,r){arguments[4][27][0].apply(r,arguments)},{dup:27}],120:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],121:[function(e,t,r){arguments[4][29][0].apply(r,arguments)},{dup:29}],122:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{"./assert":104,dup:30,semver:557,superstruct:601}],123:[function(e,t,r){let{urlAlphabet:n}=e("./url-alphabet/index.cjs"),i=e=>crypto.getRandomValues(new Uint8Array(e)),s=(e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*n*t/e.length);return(s=t)=>{let o="";for(;;){let t=r(i),a=i;for(;a--;)if(o+=e[t[a]&n]||"",o.length===s)return o}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>s(e,t,i),customRandom:s,urlAlphabet:n,random:i}},{"./url-alphabet/index.cjs":124}],124:[function(e,t,r){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}},{}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BasePostMessageStream=void 0;const n=e("readable-stream"),i=()=>{},s="SYN",o="ACK";class a extends n.Duplex{constructor(){super({objectMode:!0}),this._init=!1,this._haveSyn=!1,this._log=()=>null}_handshake(){this._write(s,null,i),this.cork()}_onData(e){if(this._init)try{this.push(e),this._log(e,!1)}catch(e){this.emit("error",e)}else e===s?(this._haveSyn=!0,this._write(o,null,i)):e===o&&(this._init=!0,this._haveSyn||this._write(o,null,i),this.uncork())}_read(){}_write(e,t,r){e!==o&&e!==s&&this._log(e,!0),this._postMessage(e),r()}_setLogger(e){this._log=e}}r.BasePostMessageStream=a},{"readable-stream":141}],126:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WebWorkerParentPostMessageStream=void 0;const n=e("../BasePostMessageStream"),i=e("../utils");class s extends n.BasePostMessageStream{constructor({worker:e}){super(),this._target=i.DEDICATED_WORKER_NAME,this._worker=e,this._worker.onmessage=this._onMessage.bind(this),this._handshake()}_postMessage(e){this._worker.postMessage({target:this._target,data:e})}_onMessage(e){const t=e.data;(0,i.isValidStreamMessage)(t)&&this._onData(t.data)}_destroy(){this._worker.onmessage=null,this._worker=null}}r.WebWorkerParentPostMessageStream=s},{"../BasePostMessageStream":125,"../utils":130}],127:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.WebWorkerPostMessageStream=void 0;const n=e("../BasePostMessageStream"),i=e("../utils");class s extends n.BasePostMessageStream{constructor(){if("undefined"==typeof self||"undefined"==typeof WorkerGlobalScope)throw new Error("WorkerGlobalScope not found. This class should only be instantiated in a WebWorker.");super(),this._name=i.DEDICATED_WORKER_NAME,self.addEventListener("message",this._onMessage.bind(this)),this._handshake()}_postMessage(e){self.postMessage({data:e})}_onMessage(e){const t=e.data;(0,i.isValidStreamMessage)(t)&&t.target===this._name&&this._onData(t.data)}_destroy(){}}r.WebWorkerPostMessageStream=s},{"../BasePostMessageStream":125,"../utils":130}],128:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./window/WindowPostMessageStream"),r),i(e("./WebWorker/WebWorkerPostMessageStream"),r),i(e("./WebWorker/WebWorkerParentPostMessageStream"),r),i(e("./runtime/BrowserRuntimePostMessageStream"),r),i(e("./BasePostMessageStream"),r)},{"./BasePostMessageStream":125,"./WebWorker/WebWorkerParentPostMessageStream":126,"./WebWorker/WebWorkerPostMessageStream":127,"./runtime/BrowserRuntimePostMessageStream":129,"./window/WindowPostMessageStream":131}],129:[function(e,t,r){"use strict";var n,i,s=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},o=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.BrowserRuntimePostMessageStream=void 0;const a=e("../BasePostMessageStream"),u=e("../utils");class c extends a.BasePostMessageStream{constructor({name:e,target:t}){super(),n.set(this,void 0),i.set(this,void 0),s(this,n,e,"f"),s(this,i,t,"f"),this._onMessage=this._onMessage.bind(this),this._getRuntime().onMessage.addListener(this._onMessage),this._handshake()}_postMessage(e){this._getRuntime().sendMessage({target:o(this,i,"f"),data:e})}_onMessage(e){(0,u.isValidStreamMessage)(e)&&e.target===o(this,n,"f")&&this._onData(e.data)}_getRuntime(){var e,t;if("chrome"in globalThis&&"function"==typeof(null===(e=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===e?void 0:e.sendMessage))return chrome.runtime;if("browser"in globalThis&&"function"==typeof(null===(t=null===browser||void 0===browser?void 0:browser.runtime)||void 0===t?void 0:t.sendMessage))return browser.runtime;throw new Error("browser.runtime.sendMessage is not a function. This class should only be instantiated in a web extension.")}_destroy(){this._getRuntime().onMessage.removeListener(this._onMessage)}}r.BrowserRuntimePostMessageStream=c,n=new WeakMap,i=new WeakMap},{"../BasePostMessageStream":125,"../utils":130}],130:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isValidStreamMessage=r.DEDICATED_WORKER_NAME=void 0;const n=e("@metamask/utils");r.DEDICATED_WORKER_NAME="dedicatedWorker",r.isValidStreamMessage=function(e){return(0,n.isObject)(e)&&Boolean(e.data)&&("number"==typeof e.data||"object"==typeof e.data||"string"==typeof e.data)}},{"@metamask/utils":303}],131:[function(e,t,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.WindowPostMessageStream=void 0;const s=e("@metamask/utils"),o=e("../BasePostMessageStream"),a=e("../utils"),u=null===(n=Object.getOwnPropertyDescriptor(MessageEvent.prototype,"source"))||void 0===n?void 0:n.get;(0,s.assert)(u,"MessageEvent.prototype.source getter is not defined.");const c=null===(i=Object.getOwnPropertyDescriptor(MessageEvent.prototype,"origin"))||void 0===i?void 0:i.get;(0,s.assert)(c,"MessageEvent.prototype.origin getter is not defined.");class l extends o.BasePostMessageStream{constructor({name:e,target:t,targetOrigin:r=location.origin,targetWindow:n=window}){if(super(),"undefined"==typeof window||"function"!=typeof window.postMessage)throw new Error("window.postMessage is not a function. This class should only be instantiated in a Window.");this._name=e,this._target=t,this._targetOrigin=r,this._targetWindow=n,this._onMessage=this._onMessage.bind(this),window.addEventListener("message",this._onMessage,!1),this._handshake()}_postMessage(e){this._targetWindow.postMessage({target:this._target,data:e},this._targetOrigin)}_onMessage(e){const t=e.data;"*"!==this._targetOrigin&&c.call(e)!==this._targetOrigin||u.call(e)!==this._targetWindow||!(0,a.isValidStreamMessage)(t)||t.target!==this._name||this._onData(t.data)}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}r.WindowPostMessageStream=l},{"../BasePostMessageStream":125,"../utils":130,"@metamask/utils":303}],132:[function(e,t,r){(function(e){(function(){"use strict";!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=function(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var s,o,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,r)}));case 3:return e.nextTick((function(){t.call(null,r,n)}));case 4:return e.nextTick((function(){t.call(null,r,n,i)}));default:for(s=new Array(a-1),o=0;o<s.length;)s[o++]=arguments[o];return e.nextTick((function(){t.apply(null,s)}))}}:t.exports=e.nextTick}).call(this)}).call(this,e("_process"))},{_process:509}],133:[function(e,t,r){"use strict";var n=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=f;var s=e("core-util-is");s.inherits=e("inherits");var o=e("./_stream_readable"),a=e("./_stream_writable");s.inherits(f,o);for(var u=i(a.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=a.prototype[l])}function f(e){if(!(this instanceof f))return new f(e);o.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||n(h,this)}function h(e){e.end()}Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),f.prototype._destroy=function(e,t){this.push(null),this.end(),n(t,e)}},{"./_stream_readable":135,"./_stream_writable":137,"core-util-is":374,inherits:472,"process-nextick-args":132}],134:[function(e,t,r){"use strict";t.exports=s;var n=e("./_stream_transform"),i=e("core-util-is");function s(e){if(!(this instanceof s))return new s(e);n.call(this,e)}i.inherits=e("inherits"),i.inherits(s,n),s.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":136,"core-util-is":374,inherits:472}],135:[function(e,t,r){(function(r,n){(function(){"use strict";var i=e("process-nextick-args");t.exports=v;var s,o=e("isarray");v.ReadableState=y;e("events").EventEmitter;var a=function(e,t){return e.listeners(t).length},u=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,l=n.Uint8Array||function(){};var f=e("core-util-is");f.inherits=e("inherits");var d=e("util"),h=void 0;h=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");f.inherits(v,u);var b=["error","close","destroy","pause","resume"];function y(t,r){s=s||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,r instanceof s&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=e("string_decoder/").StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function v(t){if(s=s||e("./_stream_duplex"),!(this instanceof v))return new v(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function w(e,t,r,n,i){var s,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,x(e)}(e,o)):(i||(s=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof l||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(o,t)),s?e.emit("error",s):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?_(e,o,t,!1):k(e,o)):_(e,o,t,!1))):n||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function _(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&x(e)),k(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),w(this,e,t,!1,r)},v.prototype.unshift=function(e){return w(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return p||(p=e("string_decoder/").StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var S=8388608;function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=S?e=S:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i(A,e):A(e))}function A(e){h("emit readable"),e.emit("readable"),R(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i(M,e,t))}function M(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function T(e){h("readable nexttick read 0"),e.read(0)}function O(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function P(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var s=r.data,o=e>s.length?s.length:e;if(o===s.length?i+=s:i+=s.slice(0,e),0===(e-=o)){o===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(o));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var s=n.data,o=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,o),0===(e-=o)){o===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(o));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function C(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i(I,t,e))}function I(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function j(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}v.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?C(this):x(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&C(this),null;var n,i=t.needReadable;return h("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",i=!0),t.ended||t.reading?h("reading or ended",i=!1):i&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(r,t))),null===(n=e>0?P(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&C(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,h("pipe count=%d opts=%j",s.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:v;function c(t,r){h("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),e.removeListener("close",b),e.removeListener("finish",y),e.removeListener("drain",f),e.removeListener("error",g),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",m),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function l(){h("onend"),e.end()}s.endEmitted?i(u):n.once("end",u),e.on("unpipe",c);var f=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,R(e))}}(n);e.on("drain",f);var d=!1;var p=!1;function m(t){h("ondata"),p=!1,!1!==e.write(t)||p||((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==j(s.pipes,e))&&!d&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){h("onerror",t),v(),e.removeListener("error",g),0===a(e,"error")&&e.emit("error",t)}function b(){e.removeListener("finish",y),v()}function y(){h("onfinish"),e.removeListener("close",b),v()}function v(){h("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",b),e.once("finish",y),e.emit("pipe",n),s.flowing||(h("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,r);return this}var o=j(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},v.prototype.on=function(e,t){var r=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&x(this):i(T,this))}return r},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i(O,e,t))}(this,e)),this},v.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",(function(){if(h("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(i){(h("wrapped data"),t.decoder&&(i=t.decoder.write(i)),t.objectMode&&null==i)||(t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<b.length;s++)e.on(b[s],n.emit.bind(n,b[s]));return n._read=function(t){h("wrapped _read",t),r&&(r=!1,e.resume())},n},v._fromList=P}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":133,"./internal/streams/BufferList":138,"./internal/streams/destroy":139,"./internal/streams/stream":140,_process:509,"core-util-is":374,events:421,inherits:472,isarray:476,"process-nextick-args":132,"safe-buffer":142,"string_decoder/":143,util:360}],136:[function(e,t,r){"use strict";t.exports=o;var n=e("./_stream_duplex"),i=e("core-util-is");function s(e){this.afterTransform=function(t,r){return function(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=r&&e.push(r);i(t);var s=e._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&e._read(s.highWaterMark)}(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e),this._transformState=new s(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e,r){a(t,e,r)})):a(t)}))}function a(e,t,r){if(t)return e.emit("error",t);null!=r&&e.push(r);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},{"./_stream_duplex":133,"core-util-is":374,inherits:472}],137:[function(e,t,r){(function(r,n,i){(function(){"use strict";var s=e("process-nextick-args");function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=y;var a,u=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?i:s;y.WritableState=b;var c=e("core-util-is");c.inherits=e("inherits");var l={deprecate:e("util-deprecate")},f=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,h=n.Uint8Array||function(){};var p,m=e("./internal/streams/destroy");function g(){}function b(t,r){a=a||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,r instanceof a&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(s(i,n),s(x,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),x(e,t))}(e,r,n,t,i);else{var o=S(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||_(e,r),n?u(w,e,r,o,i):w(e,r,o,i)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function y(t){if(a=a||e("./_stream_duplex"),!(p.call(y,this)||this instanceof a))return new y(t);this._writableState=new b(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function v(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function w(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),x(e,t)}function _(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,u=!0;r;)i[a]=r,r.isBuf||(u=!1),r=r.next,a+=1;i.allBuffers=u,v(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t)}else{for(;r;){var c=r.chunk,l=r.encoding,f=r.callback;if(v(e,t,!1,t.objectMode?1:c.length,c,l,f),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function S(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),x(e,t)}))}function x(e,t){var r=S(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(y,f),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(b.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||e&&e._writableState instanceof b}})):p=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,i=this._writableState,o=!1,a=(n=e,(d.isBuffer(n)||n instanceof h)&&!i.objectMode);return a&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),s(t,r)}(this,r):(a||function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),s(n,o),i=!1),i}(this,i,e,r))&&(i.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,a,n,i,s);return u}(this,i,a,e,t,r)),o},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,x(e,t),r&&(t.finished?s(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":133,"./internal/streams/destroy":139,"./internal/streams/stream":140,_process:509,"core-util-is":374,inherits:472,"process-nextick-args":132,"safe-buffer":142,timers:618,"util-deprecate":619}],138:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,s=n.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,r=s,i=a,t.copy(r,i),a+=o.data.length,o=o.next;return s},e}()},{"safe-buffer":142}],139:[function(e,t,r){"use strict";var n=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;s||o?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})))},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":132}],140:[function(e,t,r){t.exports=e("events").EventEmitter},{events:421}],141:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":133,"./lib/_stream_passthrough.js":134,"./lib/_stream_readable.js":135,"./lib/_stream_transform.js":136,"./lib/_stream_writable.js":137}],142:[function(e,t,r){var n=e("buffer"),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=o),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:365}],143:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=f,t=3;break;default:return this.write=d,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�".repeat(r);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�".repeat(r+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�".repeat(r+2)}}(this,e,t);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�".repeat(this.lastTotal-this.lastNeed):t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r)return 0;if(i=o(t[n]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r)return 0;if(i=o(t[n]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":142}],144:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.EthereumProviderError=r.JsonRpcError=void 0;const i=e("@metamask/utils"),s=n(e("fast-safe-stringify")),o=e("./utils");class a extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!=typeof t)throw new Error('"message" must be a non-empty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data,(0,i.isPlainObject)(this.data)&&(e.data.cause=(0,o.serializeCause)(this.data.cause))),this.stack&&(e.stack=this.stack),e}toString(){return(0,s.default)(this.serialize(),u,2)}}r.JsonRpcError=a;function u(e,t){if("[Circular]"!==t)return t}r.EthereumProviderError=class extends a{constructor(e,t,r){if(!function(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}},{"./utils":148,"@metamask/utils":158,"fast-safe-stringify":425}],145:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.errorValues=r.errorCodes=void 0,r.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},r.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}}},{}],146:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.providerErrors=r.rpcErrors=void 0;const n=e("./classes"),i=e("./error-constants"),s=e("./utils");function o(e,t){const[r,i]=u(t);return new n.JsonRpcError(e,r??(0,s.getMessageFromCode)(e),i)}function a(e,t){const[r,i]=u(t);return new n.EthereumProviderError(e,r??(0,s.getMessageFromCode)(e),i)}function u(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t??void 0,r]}}return[]}r.rpcErrors={parse:e=>o(i.errorCodes.rpc.parse,e),invalidRequest:e=>o(i.errorCodes.rpc.invalidRequest,e),invalidParams:e=>o(i.errorCodes.rpc.invalidParams,e),methodNotFound:e=>o(i.errorCodes.rpc.methodNotFound,e),internal:e=>o(i.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!=typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer